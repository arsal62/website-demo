<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Level English Paper 3 Mastery</title>
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" as="style">
    <!-- Prevent render blocking -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Meta tags for SEO -->
    <meta name="description" content="Master A Level English Paper 3 with comprehensive video lectures and resources">
    <meta name="keywords" content="A Level, English, Paper 3, Education, Exam Preparation">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    <style>
        :root {
            --primary: #3b82f6;
            --primary-light: #93c5fd;
            --secondary: #1d4ed8;
            --accent: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --success: #10b981;
            --warning: #f59e0b;
            --sidebar-width: 280px;
            --card-radius: 10px;
            --transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Rubik', sans-serif;
        }

        body {
            display: flex;
            min-height: 100vh;
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
            perspective: 1000px;
        }

        /* 3D Sidebar with Depth */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 4px 0 15px rgba(0,0,0,0.1);
            z-index: 10;
            transform-style: preserve-3d;
            transform: translateZ(0);
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            right: -10px;
            width: 10px;
            height: 100%;
            background: linear-gradient(90deg, rgba(0,0,0,0.1), transparent);
            transform-origin: left;
            transform: rotateY(-5deg);
        }

        .sidebar-header {
            padding-bottom: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            transform: translateZ(20px);
        }

        .sidebar-header h1 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .sidebar-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        /* Search bar */
        .search-container {
            margin-bottom: 1rem;
            transform: translateZ(15px);
        }
        
        .search-bar {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 0.5rem;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .search-bar input {
            background: transparent;
            border: none;
            color: white;
            flex-grow: 1;
            outline: none;
            font-size: 0.9rem;
        }
        
        .search-bar input::placeholder {
            color: rgba(255,255,255,0.6);
        }
        
        .search-icon {
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .search-icon:hover {
            color: white;
        }

        .section-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 1.5rem 0 0.75rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 8px;
            transform: translateZ(15px);
        }

        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
            position: relative;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--success);
            width: 0;
            transition: width 0.3s ease;
            border-radius: 8px;
            position: absolute;
            left: 0;
            top: 0;
        }

        .lecture-list {
            list-style: none;
            transform-style: preserve-3d;
        }

        .lecture-item {
            margin-bottom: 0.5rem;
            transform-style: preserve-3d;
            transition: var(--transition);
        }

        .lecture-item:hover {
            transform: translateX(5px) translateZ(5px);
        }

        .lecture-link {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: 6px;
            color: white;
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.95rem;
            transform-style: preserve-3d;
            background: linear-gradient(
                90deg,
                rgba(255,255,255,0) 0%,
                rgba(255,255,255,0.03) 100%
            );
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .lecture-link:hover {
            background: linear-gradient(
                90deg,
                rgba(255,255,255,0.05) 0%,
                rgba(255,255,255,0.1) 100%
            );
            transform: translateX(5px) translateZ(5px);
        }

        .lecture-link.active {
            background: white;
            color: var(--primary);
            font-weight: 500;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            transform: translateX(10px) translateZ(10px);
        }

        .lecture-link.active .lecture-icon {
            color: var(--primary);
        }

        .lecture-icon {
            margin-right: 12px;
            font-size: 1rem;
            width: 20px;
            text-align: center;
            color: var(--primary-light);
            transition: var(--transition);
        }

        .lecture-duration {
            margin-left: auto;
            font-size: 0.75rem;
            opacity: 0.8;
        }

        /* Floating Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
            max-width: 900px;
            transform-style: preserve-3d;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            transform: translateZ(0);
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
            text-shadow: 0 2px 3px rgba(0,0,0,0.05);
        }

        /* Back Button */
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 8px;
            padding: 8px 0;
            transition: var(--transition);
            transform-style: preserve-3d;
            transform: translateZ(5px);
        }

        .back-btn i {
            font-size: 0.9rem;
        }

        .back-btn:hover {
            color: var(--secondary);
            transform: translateX(-5px) translateZ(5px);
        }

        /* 3D Video Card with Hover Effect */
        .video-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            overflow: hidden;
            margin-bottom: 2rem;
            transition: var(--transition);
            transform-style: preserve-3d;
            position: relative;
        }

        .video-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(29,78,216,0.05) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-10px);
        }

        .video-card:hover {
            transform: translateY(-5px) rotateX(2deg) rotateY(1deg);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .video-player-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
            transform-style: preserve-3d;
        }

        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            transform: translateZ(0);
        }

        .video-info {
            padding: 1.5rem;
            transform-style: preserve-3d;
        }

        .video-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--dark);
            transform: translateZ(10px);
        }

        .video-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 1rem;
            font-size: 0.85rem;
            color: #64748b;
            transform: translateZ(5px);
        }

        .video-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .video-description {
            color: #475569;
            line-height: 1.7;
            margin-bottom: 1.5rem;
            transform: translateZ(5px);
        }

        /* 3D Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            transform-style: preserve-3d;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
            font-size: 0.95rem;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 100%);
            transform: translateZ(5px);
            z-index: 1;
            border-radius: 6px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px) translateZ(5px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.1);
        }

        .btn-outline:hover {
            background: rgba(59, 130, 246, 0.05);
            transform: translateY(-3px) translateZ(5px);
        }

        /* 3D Resources Section */
        .resources-section {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 1.5rem;
            margin-bottom: 2rem;
            transform-style: preserve-3d;
            position: relative;
        }

        .resources-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,250,252,0.6) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-5px);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            transform: translateZ(5px);
        }

        .section-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            transform-style: preserve-3d;
        }

        /* 3D Resource Cards */
        .resource-card {
            background: var(--light);
            border-radius: 8px;
            padding: 1rem;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .resource-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            transform: rotate(30deg) translateZ(-1px);
            transition: var(--transition);
        }

        .resource-card:hover {
            transform: translateY(-5px) rotateX(1deg) rotateY(1deg) translateZ(10px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-light);
        }

        .resource-card:hover::before {
            transform: rotate(30deg) translateZ(0);
        }

        .resource-icon {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            transform: translateZ(10px);
        }

        /* 3D Tips Section */
        .tips-section {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 1.5rem;
            transform-style: preserve-3d;
            position: relative;
        }

        .tips-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.7) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-5px);
        }

        .tip-card {
            display: flex;
            gap: 15px;
            padding: 1rem 0;
            border-bottom: 1px solid #f1f5f9;
            transform-style: preserve-3d;
        }

        .tip-card:last-child {
            border-bottom: none;
        }

        .tip-icon {
            width: 40px;
            height: 40px;
            background: rgba(16, 185, 129, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--success);
            flex-shrink: 0;
            transform: translateZ(10px);
            transition: var(--transition);
        }

        .tip-card:hover .tip-icon {
            transform: translateZ(10px) rotateY(10deg);
        }

        /* Feedback Section */
        .feedback-section {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 1.5rem;
            margin-bottom: 2rem;
            transform-style: preserve-3d;
            position: relative;
        }

        .feedback-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.7) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-5px);
        }

        .feedback-form {
            margin-top: 1rem;
        }

        .form-group {
            margin-bottom: 1rem;
            transform: translateZ(5px);
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }

        .form-control {
            width: 100%;
            padding: 0.75rem;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background: #f8fafc;
            font-size: 1rem;
            transition: var(--transition);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .rating-container {
            display: flex;
            gap: 10px;
        }

        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 1.5rem;
            color: #e2e8f0;
            cursor: pointer;
        }

        .star-rating .fas.fa-star {
            color: var(--warning);
        }

        /* User Profile Styles */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            transform: translateZ(15px);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info h3 {
            font-size: 1rem;
            margin-bottom: 0.1rem;
            color: white;
        }

        .user-info p {
            font-size: 0.8rem;
            opacity: 0.8;
            color: white;
        }

        /* Categories Filter */
        .categories-filter {
            margin-bottom: 1rem;
            transform: translateZ(15px);
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 0.5rem;
        }

        .filter-option {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            color: white;
            transition: var(--transition);
        }

        .filter-option:hover {
            background: rgba(255,255,255,0.2);
        }

        .filter-option.active {
            background: white;
            color: var(--primary);
            font-weight: 500;
        }

        /* Saved Lectures List */
        .saved-lecture-list {
            list-style: none;
            transform-style: preserve-3d;
            margin-bottom: 1.5rem;
        }

        .no-saved-message {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
            padding: 0.5rem;
            text-align: center;
        }

        /* Optimization for images */
        img {
            max-width: 100%;
            height: auto;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
            cursor: pointer;
            transition: var(--transition);
            z-index: 5;
            transform-style: preserve-3d;
        }

        .fab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            border-radius: 50%;
            transform: translateZ(-5px);
        }

        .fab:hover {
            transform: translateY(-5px) translateZ(5px) rotate(10deg);
            box-shadow: 0 15px 30px rgba(239, 68, 68, 0.4);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .sidebar {
                transform: translateX(-100%) rotateY(-15deg);
                transform-origin: right;
                transition: var(--transition);
            }

            .sidebar.active {
                transform: translateX(0) rotateY(0deg);
            }

            .main-content {
                margin-left: 0;
            }

            .menu-toggle {
                display: block !important;
            }
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .header-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .video-meta {
                flex-wrap: wrap;
            }
            
            .video-title {
                font-size: 1.3rem;
            }
            
            .video-description {
                font-size: 0.95rem;
            }
            
            .tips-section, .resources-section {
                padding: 1rem;
            }
            
            .tips-icons {
                justify-content: center;
            }
            
            .tip-icon {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }
            
            .tip-content h4 {
                font-size: 1.1rem;
            }
            
            .tip-content p {
                font-size: 0.9rem;
            }
            
            .custom-video-controls {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .video-timeline {
                width: 100%;
                margin-left: 0;
                margin-top: 10px;
            }
        }
        
        @media (max-width: 576px) {
            .sidebar-header h1 {
                font-size: 1.2rem;
            }
            
            .sidebar-header p {
                font-size: 0.8rem;
            }
            
            .lecture-title {
                font-size: 0.9rem;
            }
            
            .custom-video-controls {
                gap: 3px;
            }
            
            .custom-video-controls .btn {
                padding: 5px 8px;
                font-size: 0.8rem;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-buttons .btn {
                width: 100%;
            }
            
            .filter-options {
                overflow-x: auto;
                padding-bottom: 10px;
                margin-bottom: 10px;
                white-space: nowrap;
                display: flex;
                flex-wrap: nowrap;
            }
            
            .filter-option {
                font-size: 0.8rem;
                padding: 5px 10px;
            }
            
            .video-info {
                padding: 1rem;
            }
            
            .page-title {
                font-size: 1.4rem;
            }
            
            .back-btn {
                font-size: 0.9rem;
            }
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            z-index: 5;
            cursor: pointer;
            transform-style: preserve-3d;
        }

        .menu-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            border-radius: 50%;
            transform: translateZ(-5px);
        }

        /* Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0) translateZ(0); }
            50% { transform: translateY(-10px) translateZ(5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px) translateZ(-20px); }
            to { opacity: 1; transform: translateY(0) translateZ(0); }
        }

        .animated {
            animation: fadeIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .floating {
            animation: float 4s ease-in-out infinite;
        }

        /* Accessibility Improvements */
        .lecture-link:focus,
        .btn:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .video-title,
        .video-description,
        .tip-content h4,
        .tip-content p {
            font-size: 1.1rem;
        }

        .sidebar,
        .main-content {
            color: var(--dark);
        }

        .sidebar {
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .main-content {
            background-color: #f8fafc;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 0.5s ease-out;
        }

        .spinner {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            margin-top: 10px;
            font-weight: 500;
        }

        /* Dark Mode */
        body.dark-mode {
            background-color: #1e293b;
            color: #f8fafc;
        }

        body.dark-mode .sidebar {
            background: linear-gradient(180deg, #1d4ed8 0%, #1e293b 100%);
        }

        body.dark-mode .main-content {
            background-color: #1f2937;
        }

        body.dark-mode .video-card,
        body.dark-mode .resources-section,
        body.dark-mode .tips-section {
            background-color: #374151;
        }

        body.dark-mode .video-title,
        body.dark-mode .video-description,
        body.dark-mode .tip-content h4,
        body.dark-mode .tip-content p {
            color: #f8fafc;
        }

        /* Custom Video Controls */
        .custom-video-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 1rem;
        }

        .video-timeline {
            flex-grow: 1;
            margin-left: 1rem;
        }

        .timeline-slider {
            width: 100%;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            appearance: none;
            outline: none;
        }

        .timeline-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        .timeline-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- 3D Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h1>A Level English</h1>
            <p>Paper 3 Course</p>
        </div>

        <!-- User Profile Section -->
        <div class="user-profile">
            <div class="user-avatar">
                <img src="https://ui-avatars.com/api/?name=Student&background=random" alt="Student" id="userAvatar">
            </div>
            <div class="user-info">
                <h3 id="userName">Student</h3>
                <p id="userEmail">student@example.com</p>
            </div>
        </div>

        <div class="search-container">
            <div class="search-bar">
                <input type="text" id="lectureSearch" placeholder="Search lectures...">
                <span class="search-icon">
                    <i class="fas fa-search"></i>
                </span>
            </div>
        </div>

        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Categories filter -->
        <div class="categories-filter">
            <h3 class="section-title">
                <i class="fas fa-filter"></i> Categories
            </h3>
            <div class="filter-options">
                <span class="filter-option active" data-filter="all">All</span>
                <span class="filter-option" data-filter="directed">Directed Writing</span>
                <span class="filter-option" data-filter="continuous">Continuous Writing</span>
                <span class="filter-option" data-filter="comprehension">Comprehension</span>
            </div>
        </div>

        <h3 class="section-title">
            <i class="fas fa-video"></i> Video Lectures
        </h3>
        <ul class="lecture-list" id="lectureList">
            <!-- Lectures will be added by JavaScript -->
        </ul>

        <h3 class="section-title">
            <i class="fas fa-bookmark"></i> Saved Lectures
        </h3>
        <ul class="saved-lecture-list" id="savedLectureList">
            <!-- Saved lectures will be added by JavaScript -->
        </ul>
    </nav>

    <!-- Main Content with 3D Effects -->
    <main class="main-content">
        <div class="content-header">
            <div>
                <a href="resources.html" class="back-btn">
                    <i class="fas fa-arrow-left"></i> Back to Resources
                </a>
                <h1 class="page-title">A Level Paper 1 Video Masterclass</h1>
            </div>
            <div class="header-buttons">
                <button id="resetProgressBtn" class="btn btn-outline">
                    <i class="fas fa-redo"></i> Reset Progress
                </button>
                <button id="darkModeToggle" class="btn btn-outline dark-mode-toggle">
                    <i class="fas fa-moon"></i> Dark Mode
                </button>
            </div>
        </div>

        <!-- 3D Video Card -->
        <div class="video-card animated floating">
            <div class="video-player-container">
                <div id="videoPlaceholder" style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; color:white; background:linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);">
                    <i class="fas fa-play-circle" style="font-size:3rem; margin-bottom:1rem;"></i>
                    <h2 style="font-weight:500; margin-bottom:0.5rem;">Select a Lecture</h2>
                    <p style="opacity:0.8;">Choose from the sidebar to begin</p>
                </div>
                <div id="loadingSpinner" class="loading-spinner">
                    <div class="spinner"></div>
                    <div class="loading-text">Loading video...</div>
                </div>
                <iframe id="videoPlayer" class="video-player" frameborder="0" allowfullscreen style="display:none;"></iframe>
            </div>

            <div class="video-info">
                <h1 class="video-title" id="videoTitle">A Level Paper 1 Video Lectures</h1>
                <div class="video-meta">
                    <span><i class="fas fa-chalkboard-teacher"></i> <span id="videoInstructor">Dr. Kamran Ali</span></span>
                    <span><i class="far fa-clock"></i> <span id="videoDuration">Select a lecture</span></span>
                    <span><i class="fas fa-star" style="color:var(--warning);"></i> <span id="videoRating">4.9</span></span>
                </div>
                <p class="video-description" id="videoDescription">Select a lecture from the sidebar to view detailed video explanations of key A Level Paper 1 concepts, including directed writing, continuous writing, and comprehension strategies.</p>

                <div class="action-buttons">
                    <button class="btn btn-primary" id="completeBtn" disabled>
                        <i class="fas fa-check-circle"></i> Mark as Complete
                    </button>
                    <button class="btn btn-outline" id="saveForLaterBtn">
                        <i class="fas fa-bookmark"></i> Save for Later
                    </button>
                </div>

                <div class="custom-video-controls">
                    <button class="btn btn-primary play-pause-btn">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="btn btn-outline speed-btn">
                        <i class="fas fa-tachometer-alt"></i> Speed
                    </button>
                    <button class="btn btn-outline captions-btn">
                        <i class="fas fa-closed-captioning"></i> Captions
                    </button>
                    <div class="video-timeline">
                        <input type="range" class="timeline-slider" min="0" max="100" value="0">
                    </div>
                </div>
            </div>
        </div>

        <!-- 3D Resources Section -->
        <div class="resources-section animated" id="resourcesSection" style="display:none;">
            <div class="section-header">
                <h3>
                    <i class="fas fa-paperclip"></i> Lecture Resources
                </h3>
            </div>
            <div class="resources-grid" id="resourcesGrid">
                <!-- Resources will be added by JavaScript -->
            </div>
        </div>

        <!-- 3D Tips Section -->
        <div class="tips-section animated">
            <div class="section-header">
                <h3>
                    <i class="fas fa-lightbulb"></i> Paper 1 Exam Tips
                </h3>
            </div>

            <div class="tip-card">
                <div class="tip-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="tip-content">
                    <h4>Time Management</h4>
                    <p>Allocate 45 minutes for directed writing and 1 hour 15 minutes for continuous writing.</p>
                </div>
            </div>

            <div class="tip-card">
                <div class="tip-icon">
                    <i class="fas fa-edit"></i>
                </div>
                <div class="tip-content">
                    <h4>Directed Writing</h4>
                    <p>Always follow the given format (letter, report, etc.) and address all content points.</p>
                </div>
            </div>

            <div class="tip-card">
                <div class="tip-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="tip-content">
                    <h4>Continuous Writing</h4>
                    <p>Plan your essay structure before writing - introduction, 3 body paragraphs, conclusion.</p>
                </div>
            </div>
        </div>

        <!-- 3D Feedback Section -->
        <div class="feedback-section animated">
            <div class="section-header">
                <h3>
                    <i class="fas fa-comment-dots"></i> Provide Feedback
                </h3>
            </div>
            
            <div class="feedback-form">
                <div class="form-group">
                    <label for="feedbackRating">Rate this lecture</label>
                    <div class="rating-container">
                        <div class="star-rating" id="starRating">
                            <i class="far fa-star" data-rating="1"></i>
                            <i class="far fa-star" data-rating="2"></i>
                            <i class="far fa-star" data-rating="3"></i>
                            <i class="far fa-star" data-rating="4"></i>
                            <i class="far fa-star" data-rating="5"></i>
                        </div>
                        <span id="ratingText">Select rating</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="feedbackComment">Comments (optional)</label>
                    <textarea id="feedbackComment" class="form-control" rows="3" placeholder="Share your thoughts about this lecture..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="feedbackImprovement">What could be improved?</label>
                    <select id="feedbackImprovement" class="form-control">
                        <option value="">Select an option</option>
                        <option value="content">Content quality</option>
                        <option value="clarity">Explanation clarity</option>
                        <option value="examples">More examples</option>
                        <option value="resources">Additional resources</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <button class="btn btn-primary" id="submitFeedbackBtn">
                    <i class="fas fa-paper-plane"></i> Submit Feedback
                </button>
            </div>
            
            <div id="feedbackSuccess" style="display: none; color: var(--success); margin-top: 1rem; padding: 10px; background: rgba(16, 185, 129, 0.1); border-radius: 6px;">
                <i class="fas fa-check-circle"></i> Thank you for your feedback!
            </div>
        </div>
    </main>
    
    <!-- Mobile Menu Toggle -->
    <div class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Performance optimization - defer non-critical operations
            setTimeout(() => {
                // Load saved data
                loadSavedData();

                // Check for dark mode preference
                if (localStorage.getItem('darkMode') === 'true') {
                    document.body.classList.add('dark-mode');
                    darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                }

                // Initialize the app
                initApp();
            }, 100);
        });

        // Course Data with categories - Add your Paper 1 videos here
        const courseData = [
            {
                id: 1,
                title: "Directed Writing Masterclass",
                description: "Learn the essential techniques for acing the directed writing section, including format adherence, tone adjustment, and content point coverage. Includes real exam examples and model answers.",
                duration: "18:25",
                instructor: "Dr. Kamran Ali",
                rating: "4.9",
                videoUrl: "https://www.youtube.com/embed/8uvdsjmQ_G0?enablejsapi=1",
                thumbnail: "https://img.youtube.com/vi/EXAMPLE_ID_1/maxresdefault.jpg",
                category: "directed",
                resources: [
                    {
                        title: "Format Guide",
                        type: "PDF",
                        icon: "file-pdf"
                    },
                    {
                        title: "Practice Questions",
                        type: "DOC",
                        icon: "file-word"
                    },
                    {
                        title: "Model Answers",
                        type: "PDF",
                        icon: "file-pdf"
                    }
                ],
                completed: false,
                feedbacks: []
            },
            {
                id: 2,
                title: "Continuous Writing Strategies",
                description: "Master the art of essay writing for Paper 1 with proven strategies for narrative, descriptive, and argumentative essays. Learn how to develop compelling introductions and conclusions.",
                duration: "22:40",
                instructor: "Dr. Kamran Ali",
                rating: "4.8",
                videoUrl: "https://www.youtube.com/embed/EXAMPLE_ID_2?enablejsapi=1",
                thumbnail: "https://img.youtube.com/vi/EXAMPLE_ID_2/maxresdefault.jpg",
                category: "continuous",
                resources: [
                    {
                        title: "Essay Outlines",
                        type: "PDF",
                        icon: "file-pdf"
                    },
                    {
                        title: "Vocabulary List",
                        type: "DOC",
                        icon: "file-word"
                    }
                ],
                completed: false,
                feedbacks: []
            },
            {
                id: 3,
                title: "Comprehension Techniques",
                description: "Discover systematic approaches to tackling comprehension questions, including inference skills, vocabulary in context, and summary writing techniques specific to A Level requirements.",
                duration: "15:50",
                instructor: "Dr. Kamran Ali",
                rating: "4.7",
                videoUrl: "https://www.youtube.com/embed/EXAMPLE_ID_3?enablejsapi=1",
                thumbnail: "https://img.youtube.com/vi/EXAMPLE_ID_3/maxresdefault.jpg",
                category: "comprehension",
                resources: [
                    {
                        title: "Practice Passages",
                        type: "PDF",
                        icon: "file-pdf"
                    },
                    {
                        title: "Answer Key",
                        type: "PDF",
                        icon: "file-pdf"
                    }
                ],
                completed: false,
                feedbacks: []
            },
            {
                id: 4,
                title: "Situational Writing: Letters & Emails",
                description: "Learn effective techniques for writing formal and informal letters, emails, and other forms of correspondence in the directed writing section.",
                duration: "19:10",
                instructor: "Dr. Kamran Ali",
                rating: "4.8",
                videoUrl: "https://www.youtube.com/embed/EXAMPLE_ID_4?enablejsapi=1",
                thumbnail: "https://img.youtube.com/vi/EXAMPLE_ID_4/maxresdefault.jpg",
                category: "directed",
                resources: [
                    {
                        title: "Letter Templates",
                        type: "PDF",
                        icon: "file-pdf"
                    },
                    {
                        title: "Email Examples",
                        type: "DOC",
                        icon: "file-word"
                    }
                ],
                completed: false,
                feedbacks: []
            },
            {
                id: 5,
                title: "Descriptive Writing Masterclass",
                description: "Enhance your descriptive writing with sensory details, figurative language, and precise vocabulary. Learn to create vivid scenes that engage readers.",
                duration: "24:35",
                instructor: "Dr. Kamran Ali",
                rating: "4.9",
                videoUrl: "https://www.youtube.com/embed/EXAMPLE_ID_5?enablejsapi=1",
                thumbnail: "https://img.youtube.com/vi/EXAMPLE_ID_5/maxresdefault.jpg",
                category: "continuous",
                resources: [
                    {
                        title: "Descriptive Techniques",
                        type: "PDF",
                        icon: "file-pdf"
                    },
                    {
                        title: "Vocabulary Enrichment",
                        type: "DOC",
                        icon: "file-word"
                    }
                ],
                completed: false,
                feedbacks: []
            }
        ];

        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const lectureList = document.getElementById('lectureList');
        const savedLectureList = document.getElementById('savedLectureList');
        const videoPlayer = document.getElementById('videoPlayer');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const videoTitle = document.getElementById('videoTitle');
        const videoDuration = document.getElementById('videoDuration');
        const videoInstructor = document.getElementById('videoInstructor');
        const videoRating = document.getElementById('videoRating');
        const videoDescription = document.getElementById('videoDescription');
        const resourcesSection = document.getElementById('resourcesSection');
        const resourcesGrid = document.getElementById('resourcesGrid');
        const completeBtn = document.getElementById('completeBtn');
        const saveForLaterBtn = document.getElementById('saveForLaterBtn');
        const menuToggle = document.getElementById('menuToggle');
        const darkModeToggle = document.getElementById('darkModeToggle');
        const progressBar = document.getElementById('progressBar');
        const playPauseBtn = document.querySelector('.play-pause-btn');
        const speedBtn = document.querySelector('.speed-btn');
        const captionsBtn = document.querySelector('.captions-btn');
        const timelineSlider = document.querySelector('.timeline-slider');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const lectureSearch = document.getElementById('lectureSearch');
        const filterOptions = document.querySelectorAll('.filter-option');
        const starRating = document.getElementById('starRating');
        const ratingText = document.getElementById('ratingText');
        const feedbackComment = document.getElementById('feedbackComment');
        const feedbackImprovement = document.getElementById('feedbackImprovement');
        const submitFeedbackBtn = document.getElementById('submitFeedbackBtn');
        const feedbackSuccess = document.getElementById('feedbackSuccess');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        const userEmail = document.getElementById('userEmail');

        let isPlaying = false;
        let currentSpeed = 1;
        let player = null;
        let captionsEnabled = false;
        let savedLectures = [];
        let currentLectureId = null;
        let currentRating = 0;
        let currentFilter = 'all';
        let searchTerm = '';
        let userProfile = {
            name: 'Student',
            email: 'student@example.com',
            avatar: 'https://ui-avatars.com/api/?name=Student&background=random'
        };

        // Initialize the application
        function initApp() {
            // Load user profile if exists
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                try {
                    userProfile = JSON.parse(savedProfile);
                    updateUserProfileUI();
                } catch (e) {
                    console.error('Error parsing user profile:', e);
                }
            }

            // Render lectures
            renderLectures();
            renderSavedLectures();
            updateProgressBar();

            // Initialize event listeners
            initEventListeners();

            // Load first lecture if available
            if (courseData.length > 0) {
                setTimeout(() => {
                    loadLecture(courseData[0].id);
                }, 500);
            }

            // Load YouTube API
            loadYouTubeAPI();
        }

        // Initialize all event listeners
        function initEventListeners() {
            // Search functionality
            lectureSearch.addEventListener('input', handleSearch);

            // Category filter
            filterOptions.forEach(option => {
                option.addEventListener('click', () => {
                    filterOptions.forEach(o => o.classList.remove('active'));
                    option.classList.add('active');
                    currentFilter = option.getAttribute('data-filter');
                    renderLectures();
                });
            });

            // Reset progress button
            document.getElementById('resetProgressBtn').addEventListener('click', resetAllProgress);

            // Star rating system
            const stars = starRating.querySelectorAll('.fa-star');
            stars.forEach(star => {
                star.addEventListener('mouseover', () => {
                    const rating = parseInt(star.getAttribute('data-rating'));
                    highlightStars(rating);
                });

                star.addEventListener('mouseout', () => {
                    highlightStars(currentRating);
                });

                star.addEventListener('click', () => {
                    currentRating = parseInt(star.getAttribute('data-rating'));
                    highlightStars(currentRating);
                    ratingText.textContent = `${currentRating} of 5 stars`;
                });
            });

            // Feedback form submission
            submitFeedbackBtn.addEventListener('click', submitFeedback);

            // Menu toggle for mobile
            menuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('active');
                menuToggle.innerHTML = sidebar.classList.contains('active') ?
                    '<i class="fas fa-times"></i>' : '<i class="fas fa-bars"></i>';
            });

            // Dark mode toggle
            darkModeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                darkModeToggle.innerHTML = document.body.classList.contains('dark-mode') ?
                    '<i class="fas fa-sun"></i> Light Mode' : '<i class="fas fa-moon"></i> Dark Mode';
                localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
            });

            // Complete button
            completeBtn.addEventListener('click', markLectureComplete);

            // Save for later button
            saveForLaterBtn.addEventListener('click', () => {
                if (currentLectureId) {
                    toggleSaveForLater(currentLectureId);
                }
            });

            // Video controls
            playPauseBtn.addEventListener('click', togglePlayPause);
            speedBtn.addEventListener('click', cyclePlaybackSpeed);
            captionsBtn.addEventListener('click', toggleCaptions);
            timelineSlider.addEventListener('input', seekVideo);
        }

        // Update user profile UI
        function updateUserProfileUI() {
            userName.textContent = userProfile.name;
            userEmail.textContent = userProfile.email;
            userAvatar.src = userProfile.avatar;
        }

        // Handle search functionality
        function handleSearch(e) {
            searchTerm = e.target.value.toLowerCase();
            renderLectures();
        }

        // Filter lectures
        function filterLectures(lectures) {
            return lectures.filter(lecture => {
                const matchesSearch = lecture.title.toLowerCase().includes(searchTerm) || 
                                     lecture.description.toLowerCase().includes(searchTerm);
                const matchesFilter = currentFilter === 'all' || lecture.category === currentFilter;
                return matchesSearch && matchesFilter;
            });
        }

        // Highlight stars for rating
        function highlightStars(rating) {
            const stars = starRating.querySelectorAll('.fa-star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.remove('far');
                    star.classList.add('fas');
                } else {
                    star.classList.remove('fas');
                    star.classList.add('far');
                }
            });
        }

        // Submit feedback
        function submitFeedback() {
            if (!currentLectureId || currentRating === 0) {
                alert('Please select a rating before submitting feedback.');
                return;
            }

            const lecture = courseData.find(l => l.id === currentLectureId);
            if (lecture) {
                const feedback = {
                    rating: currentRating,
                    comment: feedbackComment.value.trim(),
                    improvement: feedbackImprovement.value,
                    date: new Date().toISOString()
                };

                lecture.feedbacks.push(feedback);
                
                // Update lecture rating (average of all feedback ratings)
                if (lecture.feedbacks.length > 0) {
                    const totalRating = lecture.feedbacks.reduce((sum, item) => sum + item.rating, 0);
                    lecture.rating = (totalRating / lecture.feedbacks.length).toFixed(1);
                    videoRating.textContent = lecture.rating;
                }

                // Save to localStorage
                saveFeedbacks();

                // Reset form
                currentRating = 0;
                highlightStars(0);
                ratingText.textContent = 'Select rating';
                feedbackComment.value = '';
                feedbackImprovement.value = '';

                // Show success message
                feedbackSuccess.style.display = 'block';
                setTimeout(() => {
                    feedbackSuccess.style.display = 'none';
                }, 3000);
            }
        }

        // Save feedbacks to localStorage
        function saveFeedbacks() {
            const feedbacks = {};
            courseData.forEach(lecture => {
                feedbacks[lecture.id] = lecture.feedbacks;
            });
            localStorage.setItem('lectureFeedbacks', JSON.stringify(feedbacks));
        }

        // Load feedbacks from localStorage
        function loadFeedbacks() {
            const savedFeedbacks = localStorage.getItem('lectureFeedbacks');
            if (savedFeedbacks) {
                try {
                    const feedbacks = JSON.parse(savedFeedbacks);
                    courseData.forEach(lecture => {
                        if (feedbacks[lecture.id]) {
                            lecture.feedbacks = feedbacks[lecture.id];
                            
                            // Update lecture rating
                            if (lecture.feedbacks.length > 0) {
                                const totalRating = lecture.feedbacks.reduce((sum, item) => sum + item.rating, 0);
                                lecture.rating = (totalRating / lecture.feedbacks.length).toFixed(1);
                            }
                        }
                    });
                } catch (e) {
                    console.error('Error parsing feedbacks:', e);
                }
            }
        }

        // Mark lecture as complete
        function markLectureComplete() {
            const currentLecture = courseData.find(lecture => lecture.id === currentLectureId);
            if (currentLecture) {
                currentLecture.completed = true;
                completeBtn.innerHTML = '<i class="fas fa-check"></i> Completed';
                completeBtn.style.background = 'var(--success)';
                completeBtn.disabled = true;

                // Update lecture icon in sidebar
                const lectureLink = document.querySelector(`.lecture-link[data-id="${currentLectureId}"]`);
                if (lectureLink) {
                    const icon = lectureLink.querySelector('.lecture-icon i');
                    icon.className = 'fas fa-check-circle';
                }

                updateProgressBar();
                saveProgress();
            }
        }

        // Toggle play/pause
        function togglePlayPause() {
            if (player) {
                if (isPlaying) {
                    player.pauseVideo();
                } else {
                    player.playVideo();
                }
            }
        }

        // Cycle playback speed
        function cyclePlaybackSpeed() {
            if (player) {
                // Cycle through speeds: 0.5, 1, 1.5, 2
                const speeds = [0.5, 1, 1.5, 2];
                const currentIndex = speeds.indexOf(currentSpeed);
                const nextIndex = (currentIndex + 1) % speeds.length;
                currentSpeed = speeds[nextIndex];

                player.setPlaybackRate(currentSpeed);
                speedBtn.innerHTML = `<i class="fas fa-tachometer-alt"></i> ${currentSpeed}x`;
            }
        }

        // Toggle captions
        function toggleCaptions() {
            if (player) {
                captionsEnabled = !captionsEnabled;
                if (captionsEnabled) {
                    player.loadModule("captions");
                    player.setOption("captions", "track", {"languageCode": "en"});
                    captionsBtn.innerHTML = '<i class="fas fa-closed-captioning"></i> Captions On';
                    captionsBtn.style.background = 'var(--success)';
                } else {
                    player.unloadModule("captions");
                    captionsBtn.innerHTML = '<i class="fas fa-closed-captioning"></i> Captions Off';
                    captionsBtn.style.background = '';
                }
            }
        }

        // Seek video
        function seekVideo() {
            if (player) {
                const seekTime = player.getDuration() * (timelineSlider.value / 100);
                player.seekTo(seekTime, true);
            }
        }

        // Load YouTube API
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // Initialize YouTube player when API is ready
        window.onYouTubeIframeAPIReady = function() {
            console.log("YouTube API ready");
            // If we have a current lecture, initialize the player
            if (currentLectureId) {
                const lecture = courseData.find(l => l.id === currentLectureId);
                if (lecture) {
                    createYouTubePlayer(lecture.videoUrl);
                }
            }
        };

        // Function to create YouTube player
        function createYouTubePlayer(videoUrl) {
            if (player) {
                player.destroy();
            }

            // Extract video ID from URL
            const videoIdMatch = videoUrl.match(/embed\/([^?]+)/);
            const videoId = videoIdMatch ? videoIdMatch[1] : '';

            if (!videoId) {
                console.error('Invalid YouTube URL:', videoUrl);
                return;
            }

            // Check if YT API is loaded
            if (typeof YT === 'undefined' || !YT.Player) {
                console.error('YouTube API not loaded yet');
                // Show error in player container
                videoPlayer.style.display = 'none';
                videoPlaceholder.style.display = 'flex';
                videoPlaceholder.innerHTML = `
                    <i class="fas fa-exclamation-circle" style="font-size:3rem; margin-bottom:1rem; color:var(--accent);"></i>
                    <h2 style="font-weight:500; margin-bottom:0.5rem;">YouTube API Error</h2>
                    <p style="opacity:0.8;">Failed to load YouTube player. Please refresh the page.</p>
                `;
                hideLoadingSpinner();
                return;
            }

            try {
                player = new YT.Player('videoPlayer', {
                    height: '100%',
                    width: '100%',
                    videoId: videoId,
                    playerVars: {
                        'playsinline': 1,
                        'rel': 0,
                        'modestbranding': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange,
                        'onError': onPlayerError
                    }
                });
            } catch (error) {
                console.error('Error creating YouTube player:', error);
                hideLoadingSpinner();
                videoPlaceholder.style.display = 'flex';
                videoPlaceholder.innerHTML = `
                    <i class="fas fa-exclamation-circle" style="font-size:3rem; margin-bottom:1rem; color:var(--accent);"></i>
                    <h2 style="font-weight:500; margin-bottom:0.5rem;">Error Loading Video</h2>
                    <p style="opacity:0.8;">${error.message || 'Failed to load video player'}</p>
                `;
            }
        }

        // Handle player errors
        function onPlayerError(event) {
            console.error('YouTube player error:', event.data);
            hideLoadingSpinner();
            
            let errorMessage = 'An unknown error occurred.';
            
            // Error code reference: https://developers.google.com/youtube/iframe_api_reference#onError
            switch(event.data) {
                case 2:
                    errorMessage = 'Invalid video ID';
                    break;
                case 5:
                    errorMessage = 'HTML5 player error';
                    break;
                case 100:
                    errorMessage = 'Video not found or removed';
                    break;
                case 101:
                case 150:
                    errorMessage = 'Video owner doesn\'t allow embedding';
                    break;
            }
            
            videoPlaceholder.style.display = 'flex';
            videoPlaceholder.innerHTML = `
                <i class="fas fa-exclamation-circle" style="font-size:3rem; margin-bottom:1rem; color:var(--accent);"></i>
                <h2 style="font-weight:500; margin-bottom:0.5rem;">Video Error</h2>
                <p style="opacity:0.8;">${errorMessage}</p>
            `;
        }

        // When player is ready
        function onPlayerReady(event) {
            console.log("Player ready");
            videoPlayer.style.display = 'block';
            hideLoadingSpinner();

            // Update speed button text
            speedBtn.innerHTML = `<i class="fas fa-tachometer-alt"></i> Speed ${currentSpeed}x`;

            // Start progress update interval
            setInterval(updateVideoProgress, 1000);
            
            // Auto play video
            setTimeout(() => {
                event.target.playVideo();
            }, 500);
        }

        // When player state changes
        function onPlayerStateChange(event) {
            if (event.data == YT.PlayerState.PLAYING) {
                isPlaying = true;
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            } else if (event.data == YT.PlayerState.PAUSED) {
                isPlaying = false;
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            } else if (event.data == YT.PlayerState.ENDED) {
                // Auto-mark as completed when video ends
                if (currentLectureId) {
                    const currentLecture = courseData.find(lecture => lecture.id === currentLectureId);
                    if (currentLecture && !currentLecture.completed) {
                        markLectureComplete();
                    }
                }
            }
        }

        // Update video progress
        function updateVideoProgress() {
            if (player && player.getCurrentTime && player.getDuration) {
                const currentTime = player.getCurrentTime();
                const duration = player.getDuration();
                if (duration > 0) {
                    const percentage = (currentTime / duration) * 100;
                    timelineSlider.value = percentage;
                }
            }
        }

        // Load saved data
        function loadSavedData() {
            // Load completed lectures
            const savedProgress = localStorage.getItem('courseProgress');
            if (savedProgress) {
                try {
                    const progress = JSON.parse(savedProgress);
                    courseData.forEach(lecture => {
                        if (progress[lecture.id] && progress[lecture.id].completed === true) {
                            lecture.completed = true;
                        } else {
                            lecture.completed = false;
                        }
                    });
                } catch (e) {
                    console.error('Error parsing saved progress:', e);
                    // Reset all lectures to not completed
                    courseData.forEach(lecture => {
                        lecture.completed = false;
                    });
                    // Clear corrupted data
                    localStorage.removeItem('courseProgress');
                }
            } else {
                // If no saved progress, ensure all lectures are marked as not completed
                courseData.forEach(lecture => {
                    lecture.completed = false;
                });
            }
            
            // Load saved lectures
            const savedLecturesData = localStorage.getItem('savedLectures');
            if (savedLecturesData) {
                try {
                    savedLectures = JSON.parse(savedLecturesData);
                } catch (e) {
                    console.error('Error parsing saved lectures:', e);
                    savedLectures = [];
                    localStorage.removeItem('savedLectures');
                }
            }

            // Load feedbacks
            loadFeedbacks();
        }

        // Save progress to localStorage
        function saveProgress() {
            const progress = {};
            courseData.forEach(lecture => {
                progress[lecture.id] = {
                    completed: lecture.completed === true
                };
            });
            localStorage.setItem('courseProgress', JSON.stringify(progress));
        }

        // Render lecture list with search and filter
        function renderLectures() {
            lectureList.innerHTML = '';
            const filteredLectures = filterLectures(courseData);
            
            if (filteredLectures.length === 0) {
                lectureList.innerHTML = '<li class="no-results">No lectures found</li>';
                return;
            }

            filteredLectures.forEach(lecture => {
                const li = document.createElement('li');
                li.className = 'lecture-item animated';
                li.style.animationDelay = `${lecture.id * 0.1}s`;
                li.innerHTML = `
                    <a href="#" class="lecture-link" data-id="${lecture.id}">
                        <span class="lecture-icon">
                            <i class="fas fa-${lecture.completed ? 'check-circle' : 'play-circle'}"></i>
                        </span>
                        ${lecture.title}
                        <span class="lecture-duration">${lecture.duration}</span>
                    </a>
                `;
                lectureList.appendChild(li);

                // Add click event
                li.querySelector('.lecture-link').addEventListener('click', (e) => {
                    e.preventDefault();
                    loadLecture(lecture.id);
                });
            });

            // Highlight active lecture
            if (currentLectureId) {
                const activeLink = document.querySelector(`.lecture-link[data-id="${currentLectureId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
            }
        }

        // Render saved lectures
        function renderSavedLectures() {
            savedLectureList.innerHTML = '';
            
            if (savedLectures.length === 0) {
                savedLectureList.innerHTML = '<li class="no-saved-message">No saved lectures</li>';
                return;
            }

            savedLectures.forEach(lectureId => {
                const lecture = courseData.find(l => l.id === lectureId);
                if (lecture) {
                    const li = document.createElement('li');
                    li.className = 'lecture-item animated';
                    li.innerHTML = `
                        <a href="#" class="lecture-link" data-id="${lecture.id}">
                            <span class="lecture-icon">
                                <i class="fas fa-bookmark"></i>
                            </span>
                            ${lecture.title}
                            <span class="lecture-duration">${lecture.duration}</span>
                        </a>
                    `;
                    savedLectureList.appendChild(li);

                    // Add click event
                    li.querySelector('.lecture-link').addEventListener('click', (e) => {
                        e.preventDefault();
                        loadLecture(lecture.id);
                    });
                }
            });
        }

        // Load lecture
        function loadLecture(lectureId) {
            showLoadingSpinner();
            currentLectureId = lectureId;
            const lecture = courseData.find(l => l.id === lectureId);

            if (lecture) {
                // Hide placeholder
                videoPlaceholder.style.display = 'none';

                // Update lecture info
                videoTitle.textContent = lecture.title;
                videoDuration.textContent = lecture.duration;
                videoInstructor.textContent = lecture.instructor;
                videoRating.textContent = lecture.rating;
                videoDescription.textContent = lecture.description;

                // Update button states
                completeBtn.disabled = false;
                if (lecture.completed) {
                    completeBtn.innerHTML = '<i class="fas fa-check"></i> Completed';
                    completeBtn.style.background = 'var(--success)';
                    completeBtn.disabled = true;
                } else {
                    completeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Mark as Complete';
                    completeBtn.style.background = '';
                }

                // Update save for later button
                updateSaveForLaterButton(lectureId);

                // Update resources
                renderResources(lecture.resources);
                resourcesSection.style.display = 'block';

                // Reset feedback form
                currentRating = 0;
                highlightStars(0);
                ratingText.textContent = 'Select rating';
                feedbackComment.value = '';
                feedbackImprovement.value = '';
                feedbackSuccess.style.display = 'none';

                // Update active state
                document.querySelectorAll('.lecture-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                const activeLink = document.querySelector(`.lecture-link[data-id="${currentLectureId}"]`);
                if (activeLink) {
                    activeLink.classList.add('active');
                }
                
                // Simple direct embedding approach
                const videoContainer = document.querySelector('.video-player-container');
                // Extract video ID from URL
                const videoIdMatch = lecture.videoUrl.match(/(?:embed\/|watch\?v=)([^?&]+)/);
                const videoId = videoIdMatch ? videoIdMatch[1] : '';
                
                if (videoId) {
                    videoPlayer.style.display = 'block';
                    videoPlayer.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&modestbranding=1&rel=0`;
                    
                    // Hide loading spinner after a short delay
                    setTimeout(hideLoadingSpinner, 1000);
                } else {
                    console.error('Invalid YouTube URL:', lecture.videoUrl);
                    videoPlaceholder.style.display = 'flex';
                    videoPlaceholder.innerHTML = `
                        <i class="fas fa-exclamation-circle" style="font-size:3rem; margin-bottom:1rem; color:var(--accent);"></i>
                        <h2 style="font-weight:500; margin-bottom:0.5rem;">Invalid Video URL</h2>
                        <p style="opacity:0.8;">Could not extract video ID from URL.</p>
                    `;
                    hideLoadingSpinner();
                }
            }
        }

        // Update save for later button
        function updateSaveForLaterButton(lectureId) {
            const isSaved = savedLectures.includes(lectureId);
            saveForLaterBtn.innerHTML = isSaved ?
                '<i class="fas fa-bookmark"></i> Saved' :
                '<i class="fas fa-bookmark"></i> Save for Later';
            saveForLaterBtn.style.background = isSaved ? 'var(--success)' : '';
        }

        // Toggle save for later
        function toggleSaveForLater(lectureId) {
            const index = savedLectures.indexOf(lectureId);
            if (index === -1) {
                savedLectures.push(lectureId);
            } else {
                savedLectures.splice(index, 1);
            }
            localStorage.setItem('savedLectures', JSON.stringify(savedLectures));
            updateSaveForLaterButton(lectureId);
            renderSavedLectures();
        }

        // Render resources
        function renderResources(resources) {
            resourcesGrid.innerHTML = '';
            if (resources && resources.length > 0) {
                resources.forEach((resource, index) => {
                    const card = document.createElement('div');
                    card.className = 'resource-card animated';
                    card.style.animationDelay = `${index * 0.1}s`;
                    card.innerHTML = `
                        <div class="resource-icon">
                            <i class="fas fa-${resource.icon}"></i>
                        </div>
                        <h4 class="resource-title">${resource.title}</h4>
                        <p class="resource-type">${resource.type}</p>
                    `;
                    resourcesGrid.appendChild(card);

                    // Add click event for downloading resources
                    card.addEventListener('click', () => {
                        alert(`Downloading ${resource.title}.${resource.type.toLowerCase()}`);
                        // In a real app, you would implement actual download functionality here
                    });
                }); 
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const completedLectures = courseData.filter(lecture => lecture.completed).length;
            const totalLectures = courseData.length;
            const progressPercentage = (completedLectures / totalLectures) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            
            // Add progress text
            const progressText = document.createElement('div');
            progressText.className = 'progress-text';
            progressText.style.color = 'white';
            progressText.style.fontSize = '0.8rem';
            progressText.style.marginTop = '0.5rem';
            progressText.textContent = `${completedLectures}/${totalLectures} lectures completed`;
            
            const existingText = progressBar.parentElement.querySelector('.progress-text');
            if (existingText) {
                existingText.remove();
            }
            progressBar.parentElement.appendChild(progressText);
            
            // Update color based on completion
            if (progressPercentage === 100) {
                progressBar.style.backgroundColor = '#10b981'; // var(--success)
            } else if (progressPercentage > 0) {
                progressBar.style.backgroundColor = '#f59e0b'; // var(--warning)
            }
        }

        // Show loading spinner
        function showLoadingSpinner() {
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = 'flex';
            spinner.style.opacity = '1';
        }

        // Hide loading spinner
        function hideLoadingSpinner() {
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.opacity = '0';
            setTimeout(() => {
                spinner.style.display = 'none';
            }, 500); // Match the transition duration from CSS
        }

        // Reset all progress
        function resetAllProgress() {
            if (!confirm("Are you sure you want to reset all your progress? This will clear all completed lectures, saved lectures, and feedback.")) {
                return;
            }
            
            // Reset course data
            courseData.forEach(lecture => {
                lecture.completed = false;
                lecture.feedbacks = [];
            });
            
            // Clear localStorage
            localStorage.removeItem('courseProgress');
            localStorage.removeItem('savedLectures');
            localStorage.removeItem('lectureFeedbacks');
            
            // Reset saved lectures array
            savedLectures = [];
            
            // Update UI
            renderLectures();
            renderSavedLectures();
            updateProgressBar();
            
            // Update current lecture UI if one is loaded
            if (currentLectureId) {
                const lecture = courseData.find(l => l.id === currentLectureId);
                if (lecture) {
                    completeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Mark as Complete';
                    completeBtn.style.background = '';
                    completeBtn.disabled = false;
                    videoRating.textContent = lecture.rating;
                    updateSaveForLaterButton(currentLectureId);
                }
            }
            
            alert("Progress successfully reset!");
        }
    </script>
</body>
</html>
