<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paper 2 - Video Lectures | DK Academy</title>
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" as="style">
    <!-- Prevent render blocking -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Meta tags for SEO -->
    <meta name="description" content="Master O Level English Paper 2 with comprehensive video lectures and resources">
    <meta name="keywords" content="O Level, English, Paper 2, Education, Exam Preparation">
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="stylesheet" href="exam-tips-mobile.css">
    <link rel="stylesheet" href="css/exam-tips-responsive.css">
    <link rel="stylesheet" href="css/mobile-video-controls.css">
   

    <style>
        :root {
            --primary: #3b82f6;
            --primary-light: #93c5fd;
            --secondary: #1d4ed8;
            --accent: #ef4444;
            --dark: #1e293b;
            --light: #f8fafc;
            --success: #10b981;
            --warning: #f59e0b;
            --sidebar-width: 280px;
            --card-radius: 10px;
            --transition: all 0.25s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            --card-bg: #ffffff;
            --card-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --border: #e2e8f0;
            --input-bg: #f8fafc;
            --text: #475569;
            --text-secondary: #64748b;
            --star: #ffd700;
            --success-bg: rgba(16, 185, 129, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Rubik', sans-serif;
        }

        body {
            display: flex;
            min-height: 100vh;
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.6;
            perspective: 1000px;
        }

        /* 3D Sidebar with Depth */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            height: 100vh;
            position: fixed;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 4px 0 15px rgba(0,0,0,0.1);
            z-index: 10;
            transform-style: preserve-3d;
            transform: translateZ(0);
            border-right: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar::before {
            content: '';
            position: absolute;
            top: 0;
            right: -10px;
            width: 10px;
            height: 100%;
            background: linear-gradient(90deg, rgba(0,0,0,0.1), transparent);
            transform-origin: left;
            transform: rotateY(-5deg);
        }

        .sidebar-header {
            padding-bottom: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            transform: translateZ(20px);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .sidebar-header h1 {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .sidebar-header p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        /* DK Logo Styles */
        .logo-container {
            width: 80px;
            height: 80px;
            position: relative;
            margin-bottom: 15px;
            transform-style: preserve-3d;
            cursor: pointer;
            overflow: visible;
        }
        
        .logo-text {
            position: absolute;
            font-size: 42px;
            font-weight: 800;
            color: white;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
            letter-spacing: -2px;
            transform: translateZ(30px);
            user-select: none;
            font-family: 'Rubik', sans-serif;
            background: linear-gradient(to bottom, #ffffff, #d0d0d0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            transition: all 0.3s ease;
        }
        
        .logo-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(145deg, rgba(255,255,255,0.1), rgba(59,130,246,0.2));
            transform-style: preserve-3d;
            transition: all 0.5s ease;
        }
        
        .logo-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            transform: translateZ(5px);
            filter: blur(1px);
            opacity: 0.7;
            transition: all 0.3s ease;
        }

        /* Search bar */
        .search-container {
            margin-bottom: 1rem;
            transform: translateZ(15px);
        }
        
        .search-bar {
            display: flex;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 0.5rem;
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .search-bar input {
            background: transparent;
            border: none;
            color: white;
            flex-grow: 1;
            outline: none;
            font-size: 0.9rem;
        }
        
        .search-bar input::placeholder {
            color: rgba(255,255,255,0.6);
        }
        
        .search-icon {
            color: rgba(255,255,255,0.6);
            cursor: pointer;
            transition: var(--transition);
        }
        
        .search-icon:hover {
            color: white;
        }

        .section-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 1.5rem 0 0.75rem;
            opacity: 0.8;
            display: flex;
            align-items: center;
            gap: 8px;
            transform: translateZ(15px);
        }

        .progress-bar-container {
            width: 100%;
            background-color: #e2e8f0;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
            position: relative;
            height: 24px; /* Explicitly set height */
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .progress-bar {
            height: 100%;
            background: #22c55e; /* Direct color instead of var(--success) */
            width: 0%; /* Always start at 0% */
            transition: width 0.8s ease-in-out;
            border-radius: 8px;
            position: absolute;
            left: 0;
            top: 0;
        }
        
        .progress-text {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1e293b; /* Dark color for visibility */
            font-size: 12px;
            font-weight: 500;
            z-index: 5;
            text-shadow: 0 1px 0 rgba(255,255,255,0.5);
        }
        
        .progress-bar.animating {
            transition: width 0.8s cubic-bezier(0.22, 0.61, 0.36, 1);
        }
        
        .completion-animation {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 150px; /* Bigger */
            color: #22c55e; /* Brighter green */
            opacity: 0;
            z-index: 100;
            animation: completion-fade 2s ease-in-out; /* Longer animation */
            pointer-events: none;
            text-shadow: 0 0 20px rgba(34, 197, 94, 0.6); /* Add glow */
        }
        
        @keyframes completion-fade {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            40% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.5); /* Larger scale */
            }
            80% {
                opacity: 0.8;
                transform: translate(-50%, -50%) scale(1.2);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        /* Also update the completed style for the button */
        .btn.completed {
            background: #22c55e; /* Same green */
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn.completed:hover {
            background: #16a34a; /* Darker green */
            transform: translateY(-3px);
        }

        .lecture-list {
            list-style: none;
            transform-style: preserve-3d;
        }

        .lecture-item {
            margin-bottom: 0.5rem;
            transform-style: preserve-3d;
            transition: var(--transition);
        }

        .lecture-item:hover {
            transform: translateX(5px) translateZ(5px);
        }

        .lecture-link {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-radius: 6px;
            color: white;
            text-decoration: none;
            transition: var(--transition);
            font-size: 0.95rem;
            transform-style: preserve-3d;
            background: linear-gradient(
                90deg,
                rgba(255,255,255,0) 0%,
                rgba(255,255,255,0.03) 100%
            );
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }

        .lecture-link:hover {
            background: linear-gradient(
                90deg,
                rgba(255,255,255,0.05) 0%,
                rgba(255,255,255,0.1) 100%
            );
            transform: translateX(5px) translateZ(5px);
        }

        .lecture-link.active {
            background: white;
            color: var(--primary);
            font-weight: 500;
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            transform: translateX(10px) translateZ(10px);
        }

        .lecture-link.active .lecture-icon {
            color: var(--primary);
        }

        .lecture-icon {
            margin-right: 12px;
            font-size: 1rem;
            width: 20px;
            text-align: center;
            color: var(--primary-light);
            transition: var(--transition);
        }

        .lecture-duration {
            margin-left: auto;
            font-size: 0.75rem;
            opacity: 0.8;
        }

        /* Floating Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 2rem;
            max-width: 900px;
            transform-style: preserve-3d;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            transform: translateZ(0);
        }

        .header-buttons {
            display: flex;
            gap: 10px;
        }

        .page-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: var(--dark);
            text-shadow: 0 2px 3px rgba(0,0,0,0.05);
        }

        /* Back Button */
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 8px;
            padding: 8px 0;
            transition: var(--transition);
            transform-style: preserve-3d;
            transform: translateZ(5px);
        }

        .back-btn i {
            font-size: 0.9rem;
        }

        .back-btn:hover {
            color: var(--secondary);
            transform: translateX(-5px) translateZ(5px);
        }

        /* 3D Video Card with Hover Effect */
        .video-card {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            overflow: hidden;
            margin-bottom: 2rem;
            transition: var(--transition);
            transform-style: preserve-3d;
            position: relative;
        }

        .video-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(29,78,216,0.05) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-10px);
        }

        .video-card:hover {
            transform: translateY(-5px) rotateX(2deg) rotateY(1deg);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .video-player-container {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            background: #000;
            transform-style: preserve-3d;
        }

        .video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            transform: translateZ(0);
        }

        .video-info {
            padding: 1.5rem;
            transform-style: preserve-3d;
        }

        .video-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            color: var(--dark);
            transform: translateZ(10px);
        }

        .video-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 1rem;
            font-size: 0.85rem;
            color: #64748b;
            transform: translateZ(5px);
        }

        .video-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .video-description {
            color: #475569;
            line-height: 1.7;
            margin-bottom: 1.5rem;
            transform: translateZ(5px);
        }

        /* 3D Buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            transform-style: preserve-3d;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            border: none;
            font-size: 0.95rem;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 100%);
            transform: translateZ(5px);
            z-index: 1;
            border-radius: 6px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px) translateZ(5px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.1);
        }

        .btn-outline:hover {
            background: rgba(59, 130, 246, 0.05);
            transform: translateY(-3px) translateZ(5px);
        }

        /* 3D Resources Section */
        .resources-section {
            background: white;
            border-radius: var(--card-radius);
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            padding: 1.5rem;
            margin-bottom: 2rem;
            transform-style: preserve-3d;
            position: relative;
        }

        .resources-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.8) 0%, rgba(248,250,252,0.6) 100%);
            border-radius: var(--card-radius);
            z-index: -1;
            transform: translateZ(-5px);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            transform: translateZ(5px);
        }

        .section-header h3 {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            transform-style: preserve-3d;
        }

        /* 3D Resource Cards */
        .resource-card {
            background: var(--light);
            border-radius: 8px;
            padding: 1rem;
            transition: var(--transition);
            border: 1px solid rgba(0, 0, 0, 0.05);
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
        }

        .resource-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                to bottom right,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            transform: rotate(30deg) translateZ(-1px);
            transition: var(--transition);
        }

        .resource-card:hover {
            transform: translateY(-5px) rotateX(1deg) rotateY(1deg) translateZ(10px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-light);
        }

        .resource-card:hover::before {
            transform: rotate(30deg) translateZ(0);
        }

        .resource-icon {
            width: 40px;
            height: 40px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.1rem;
            transform: translateZ(10px);
        }

        /* Enhanced Paper 2 Tips Section */
        .tips-section {
            background: linear-gradient(to right, #ffffff, #f8f9fa);
            border-radius: var(--card-radius);
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            padding: 1.5rem;
            transform-style: preserve-3d;
            position: relative;
            overflow: hidden;
            min-height: 300px;
        }
        
        .tips-icons {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 30px;
        }
        
        .tip-icon-btn {
            width: 60px;
            height: 60px;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            flex-shrink: 0;
            transform: translateZ(10px);
            transition: all 0.3s ease;
            font-size: 1.4rem;
            cursor: pointer;
            border: 2px solid transparent;
        }
        
        .tip-icon-btn:hover {
            transform: translateZ(15px) scale(1.1);
            background: rgba(59, 130, 246, 0.2);
        }
        
        .tip-icon-btn.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
            border: 2px solid white;
        }
        
        .tip-cards-container {
            position: relative;
            min-height: 150px;
        }
        
        .tip-card {
            display: flex;
            gap: 20px;
            padding: 1.5rem;
            border-radius: 10px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transform-style: preserve-3d;
            border-left: 4px solid var(--primary);
            position: absolute;
            left: 0;
            right: 0;
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px) translateZ(0);
            transition: all 0.5s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .tip-card.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) translateZ(5px);
        }
        
        @keyframes tipIn {
            0% {
                opacity: 0;
                transform: translateY(20px) translateZ(0);
            }
            100% {
                opacity: 1;
                transform: translateY(0) translateZ(5px);
            }
        }
        
        @keyframes tipOut {
            0% {
                opacity: 1;
                transform: translateY(0) translateZ(5px);
            }
            100% {
                opacity: 0;
                transform: translateY(-20px) translateZ(0);
            }
        }
        
        .tip-content h4 {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }

        .tip-content p {
            color: #64748b;
            line-height: 1.7;
        }

        /* Enhanced Feedback Section */
        .feedback-section {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--card-shadow);
        }
        
        .feedback-section h3 {
            margin-top: 0;
            color: var(--primary);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .feedback-section h3 i {
            color: var(--accent);
        }
        
        .star-rating {
            display: flex;
            gap: 5px;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .star-rating i {
            cursor: pointer;
            color: #ccc;
            transition: color 0.2s ease;
        }
        
        .star-rating i.fas {
            color: var(--star);
        }
        
        .rating-text {
            font-size: 14px;
            margin-top: 5px;
            color: var(--text-secondary);
        }
        
        .feedback-form {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .feedback-form textarea,
        .feedback-form input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 4px;
            background: var(--input-bg);
            color: var(--text);
            resize: vertical;
            transition: border-color 0.2s ease;
        }
        
        .feedback-form textarea:focus,
        .feedback-form input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .feedback-form button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.2s ease;
            align-self: flex-start;
        }
        
        .feedback-form button:hover {
            background: var(--primary-dark);
        }
        
        .feedback-success {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            background-color: var(--success-bg);
            color: var(--success);
            display: none;
        }

        /* User Profile Styles */
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            transform: translateZ(15px);
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.3);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .user-info h3 {
            font-size: 1rem;
            margin-bottom: 0.1rem;
            color: white;
        }

        .user-info p {
            font-size: 0.8rem;
            opacity: 0.8;
            color: white;
        }

        /* Categories Filter */
        .categories-filter {
            margin-bottom: 1rem;
            transform: translateZ(15px);
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 0.5rem;
        }

        .filter-option {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            background: rgba(255,255,255,0.1);
            color: white;
            transition: var(--transition);
        }

        .filter-option:hover {
            background: rgba(255,255,255,0.2);
        }

        .filter-option.active {
            background: white;
            color: var(--primary);
            font-weight: 500;
        }

        /* Saved Lectures List */
        .saved-lecture-list {
            list-style: none;
            transform-style: preserve-3d;
            margin-bottom: 1.5rem;
        }

        .no-saved-message {
            color: rgba(255,255,255,0.6);
            font-size: 0.9rem;
            padding: 0.5rem;
            text-align: center;
        }

        /* Optimization for images */
        img {
            max-width: 100%;
            height: auto;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 56px;
            height: 56px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
            cursor: pointer;
            transition: var(--transition);
            z-index: 5;
            transform-style: preserve-3d;
        }

        .fab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            border-radius: 50%;
            transform: translateZ(-5px);
        }

        .fab:hover {
            transform: translateY(-5px) translateZ(5px) rotate(10deg);
            box-shadow: 0 15px 30px rgba(239, 68, 68, 0.4);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .sidebar {
                position: fixed;
                left: -300px;
                width: 280px;
                height: 100%;
                transition: all 0.3s ease;
                z-index: 9999;
                background: var(--sidebar-bg);
                box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .content {
                margin-left: 0;
                width: 100%;
            }
            
            .toggle-btn {
                display: flex !important;
                position: fixed;
                top: 10px;
                left: 10px;
                z-index: 10000;
                background: var(--primary);
                color: white;
                border: none;
                border-radius: 4px;
                padding: 8px 12px;
                cursor: pointer;
                box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            }
            
            .video-player-container {
                height: auto;
                min-height: 250px;
            }
            
            /* Make feedback section visible on mobile */
            .feedback-section {
                display: block !important;
                width: 100%;
                margin-top: 20px;
                padding: 15px;
            }
            
            /* Ensure proper spacing in content area */
            .content-area {
                padding: 15px;
                padding-top: 60px; /* Give space for fixed toggle button */
            }
        }

        /* Enhanced Mobile Responsiveness */
        @media (max-width: 768px) {
            .content-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .header-buttons {
                width: 100%;
                justify-content: space-between;
            }
            
            .video-meta {
                flex-wrap: wrap;
            }
            
            .video-title {
                font-size: 1.3rem;
            }
            
            .video-description {
                font-size: 0.95rem;
            }
            
            
           
            
            
            .custom-video-controls {
                flex-wrap: wrap;
                gap: 5px;
            }
            
            .video-timeline {
                width: 100%;
                margin-left: 0;
                margin-top: 10px;
            }
        }
        
        @media (max-width: 576px) {
            .sidebar-header h1 {
                font-size: 1.2rem;
            }
            
            .sidebar-header p {
                font-size: 0.8rem;
            }
            
            .lecture-title {
                font-size: 0.9rem;
            }
            
            .custom-video-controls {
                gap: 3px;
            }
            
            .custom-video-controls .btn {
                padding: 5px 8px;
                font-size: 0.8rem;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-buttons .btn {
                width: 100%;
            }
            
            .filter-options {
                overflow-x: auto;
                padding-bottom: 10px;
                margin-bottom: 10px;
                white-space: nowrap;
                display: flex;
                flex-wrap: nowrap;
            }
            
            .filter-option {
                font-size: 0.8rem;
                padding: 5px 10px;
            }
            
            .video-info {
                padding: 1rem;
            }
            
            .page-title {
                font-size: 1.4rem;
            }
            
            .back-btn {
                font-size: 0.9rem;
            }
        }

        /* Mobile Menu Toggle */
        .menu-toggle {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            width: 50px;
            height: 50px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: none;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
            z-index: 5;
            cursor: pointer;
            transform-style: preserve-3d;
        }

        .menu-toggle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                135deg,
                rgba(255,255,255,0.3) 0%,
                rgba(255,255,255,0) 60%
            );
            border-radius: 50%;
            transform: translateZ(-5px);
        }

        @media (max-width: 768px) {
    .tips-section {
        padding: 1rem;
        min-height: auto;
    }

    .tips-icons {
        justify-content: center;
        gap: 10px;
    }

    .tip-icon-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }

    .tip-cards-container {
        min-height: auto;
    }

    .tip-card {
        padding: 1rem;
        gap: 10px;
    }

    .tip-content h4 {
        font-size: 1rem;
    }

    .tip-content p {
        font-size: 0.85rem;
    }
}

@media (max-width: 376px) {
    .tips-section {
        padding: 0.5rem;
    }

    .tip-icon-btn {
        width: 35px;
        height: 35px;
        font-size: 0.9rem;
    }

    .tip-card {
        padding: 0.75rem;
    }

    .tip-content h4 {
        font-size: 0.9rem;
    }

    .tip-content p {
        font-size: 0.8rem;
    }
}


        

        /* Animation */
        @keyframes float {
            0%, 100% { transform: translateY(0) translateZ(0); }
            50% { transform: translateY(-10px) translateZ(5px); }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px) translateZ(-20px); }
            to { opacity: 1; transform: translateY(0) translateZ(0); }
        }

        .animated {
            animation: fadeIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .floating {
            animation: float 4s ease-in-out infinite;
        }

        /* Accessibility Improvements */
        .lecture-link:focus,
        .btn:focus {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        .video-title,
        .video-description,
        .tip-content h4,
        .tip-content p {
            font-size: 1.1rem;
        }

        .sidebar,
        .main-content {
            color: var(--dark);
        }

        .sidebar {
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
        }

        .main-content {
            background-color: #f8fafc;
        }

        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            z-index: 10;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: opacity 0.3s ease;
        }

        .spinner {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 15px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            margin-top: 10px;
            font-weight: 500;
        }

        /* Dark Mode */
        body.dark-mode {
            background-color: #1e293b;
            color: #f8fafc;
        }

        body.dark-mode .sidebar {
            background: linear-gradient(180deg, #1d4ed8 0%, #1e293b 100%);
        }

        body.dark-mode .main-content {
            background-color: #1f2937;
        }

        body.dark-mode .video-card,
        body.dark-mode .resources-section,
        body.dark-mode .tips-section {
            background-color: #374151;
        }

        body.dark-mode .video-title,
        body.dark-mode .video-description,
        body.dark-mode .tip-content h4,
        body.dark-mode .tip-content p {
            color: #f8fafc;
        }

        /* Custom Video Controls */
        .custom-video-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 1rem;
            transition: opacity 0.3s ease;
        }
        
        .video-timeline {
            flex-grow: 1;
            margin-left: 1rem;
        }
        
        .timeline-slider {
            width: 100%;
            height: 4px;
            background: #e2e8f0;
            border-radius: 2px;
            appearance: none;
            outline: none;
        }

        .timeline-slider::-webkit-slider-thumb {
            appearance: none;
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }
        
        .timeline-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-warning:hover {
            background: #e69500;
            transform: translateY(-3px);
        }
        
        /* Video controls overlay styling */
        .video-controls-overlay {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            z-index: 20;
            opacity: 1;
            transition: opacity 0.3s ease;
        }
        
        .video-controls-right {
            display: flex;
            gap: 10px;
        }
        
        .control-btn {
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .control-btn:hover {
            background: rgba(0, 0, 0, 0.8);
        }
        
        .youtube-direct-link {
            background: rgba(255, 0, 0, 0.8);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .tap-instruction {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 14px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .video-player-container:hover .tap-instruction {
            opacity: 1;
        }
        
        @media (max-width: 768px) {
            .custom-video-controls {
                position: absolute;
                bottom: 10px;
                left: 0;
                right: 0;
                background: rgba(0,0,0,0.5);
                padding: 10px;
                border-radius: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
                opacity: 0; /* Hidden by default on mobile */
                z-index: 30;
                transition: opacity 0.3s ease;
            }
            
            .video-controls-overlay {
                bottom: 10px;
                z-index: 25;
            }
            
            .control-btn {
                width: 44px;
                height: 44px;
                font-size: 18px;
            }
            
            .youtube-direct-link {
                font-size: 14px;
                padding: 6px 10px;
                background: rgba(255, 0, 0, 0.9);
            }
            
            .video-player-container {
                position: relative;
            }
            
            .tap-instruction {
                font-size: 14px;
                opacity: 1;
                animation: fadeOut 3s forwards;
                animation-delay: 3s;
            }

            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        }

        /* Premium DK Logo Animation */
        .dk-logo-container {
            width: 120px;
            height: 120px;
            position: relative;
            margin: 0 auto 20px;
            transform-style: preserve-3d;
            cursor: pointer;
            perspective: 1000px;
        }
        
        .dk-logo-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            animation: logoFloat 6s ease-in-out infinite;
        }
        
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0) rotateY(0deg); }
            25% { transform: translateY(-5px) rotateY(5deg); }
            50% { transform: translateY(0) rotateY(0deg); }
            75% { transform: translateY(5px) rotateY(-5deg); }
        }
        
        .dk-logo-circle {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #1d4ed8, #3b82f6);
            box-shadow: 
                0 0 15px rgba(59, 130, 246, 0.5),
                0 0 30px rgba(59, 130, 246, 0.2);
            transform: translateZ(0);
            overflow: hidden;
            z-index: 1;
        }
        
        .dk-logo-circle::before {
            content: '';
            position: absolute;
            top: -20%;
            left: -20%;
            width: 140%;
            height: 140%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transform: rotate(45deg) translateY(-80px);
            animation: shineEffect 3s infinite;
        }
        
        @keyframes shineEffect {
            0% { transform: rotate(45deg) translateY(-150px); }
            50% { transform: rotate(45deg) translateY(150px); }
            100% { transform: rotate(45deg) translateY(150px); }
        }
        
        .dk-logo-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(20px);
            font-size: 48px;
            font-weight: 900;
            font-family: 'Rubik', sans-serif;
            background: linear-gradient(to bottom, #ffffff, #e2e8f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 
                0 1px 0 rgba(255,255,255,0.4),
                0 10px 10px rgba(0,0,0,0.4);
            letter-spacing: -1px;
            z-index: 3;
        }
        
        .dk-logo-glow {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 110px;
            height: 110px;
            border-radius: 50%;
            background: transparent;
            box-shadow: 0 0 30px rgba(59, 130, 246, 0.7);
            opacity: 0.5;
            animation: glowPulse 2s ease-in-out infinite;
            z-index: 0;
        }
        
        @keyframes glowPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }
        
        .dk-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            opacity: 0;
            z-index: 2;
        }
        
        .dk-logo-ring {
            position: absolute;
            top: 0;
            left: 0;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.1);
            animation: rotateSlow 10s linear infinite;
        }
        
        @keyframes rotateSlow {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .dk-logo-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 0 5px rgba(255,255,255,0.7);
        }

        body.dark-mode .admin-form input,
        body.dark-mode .admin-form textarea,
        body.dark-mode .admin-form select,
        body.dark-mode .resource-item {
            background-color: #1f2937;
            border-color: #4b5563;
            color: #f8fafc;
        }

        /* Fullscreen button */
        .fullscreen-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            border-radius: 4px;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 5;
            transition: background 0.2s ease;
        }

        .fullscreen-btn:hover {
            background: rgba(0, 0, 0, 0.7);
        }
        
        /* Video controls overlay */
        .video-controls-overlay {
            position: absolute;
            bottom: 10px;
            right: 10px;
            left: 10px;
            z-index: 10;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 5px;
        }
        
        .video-controls-right {
            display: flex;
            gap: 10px;
        }
        
        .youtube-direct-link {
            display: none; /* Hidden by default, shown on mobile */
            background: rgba(255, 0, 0, 0.8);
            color: white;
            text-decoration: none;
            padding: 10px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
            transition: all 0.2s ease;
        }
        
        .youtube-direct-link:hover {
            background: rgb(255, 0, 0);
            transform: translateY(-2px);
        }
        
        .youtube-direct-link i {
            font-size: 1.2rem;
        }
        
        .control-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }
        
        .control-btn:hover {
            background: rgba(0, 0, 0, 0.8);
        }
        
        .tap-instruction {
            display: none;
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 0.85rem;
            align-items: center;
            gap: 8px;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.3);
        }

        /* Mobile Enhancements */
        @media (max-width: 768px) {
            /* Navigation adjustments */
            .toggle-btn {
                width: 40px;
                height: 40px;
                display: flex !important;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
                padding: 0;
            }
            
            .lecture-item {
                padding: 12px;
                margin-bottom: 8px;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 8px;
            }
            
            /* Make action buttons more thumb-friendly */
            .action-buttons .btn {
                padding: 12px 16px;
                font-size: 1.05rem;
                border-radius: 8px;
                min-height: 48px;
            }

            /* Video container optimization for mobile */
            .video-player-container {
                min-height: 56.25vw; /* 16:9 aspect ratio */
                border-radius: 0; /* Full width on mobile */
                margin: -15px -15px 20px -15px; /* Break out of container padding */
                position: relative;
                overflow: hidden;
            }
            
            /* Video player fills container */
            .video-player {
                border: none;
                margin: 0;
            }
            
            /* Enhanced controls for touch */
            .custom-video-controls .btn {
                padding: 12px;
                min-width: 48px;
                min-height: 48px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                margin: 0 5px;
            }
            
            /* More touch-friendly resources */
            .resource-card {
                padding: 16px;
                margin-bottom: 12px;
                border-radius: 8px;
            }
            
            /* Show YouTube direct link on mobile */
            .youtube-direct-link {
                display: flex;
                padding: 12px 16px;
                font-size: 1rem;
            }
            
            /* Show double-tap instruction on mobile */
            .tap-instruction {
                display: flex;
                opacity: 0.8;
            }
            
            /* Optimize controls for mobile */
            .video-controls-overlay {
                bottom: 15px;
                padding: 0 10px;
                align-items: center;
            }
            
            /* Make the control buttons easy to tap */
            .control-btn {
                width: 48px;
                height: 48px;
                font-size: 1.2rem;
            }
            
            /* Auto-hide instructions after delay */
            .tap-instruction {
                animation: fadeInOut 5s forwards;
            }
            
            @keyframes fadeInOut {
                0% { opacity: 0; }
                10% { opacity: 0.9; }
                70% { opacity: 0.9; }
                100% { opacity: 0; }
            }
        }
        
        /* Landscape mode optimizations */
        @media (max-width: 768px) and (orientation: landscape) {
            .video-player-container {
                height: calc(100vh - 20px);
                min-height: calc(100vh - 20px);
                margin: 0 -15px;
            }
            
            .video-player {
                height: 100%;
            }
            
            .sidebar {
                display: none;
            }
            
            .main-content {
                margin-left: 0;
                padding-top: 0;
            }
            
            .video-info, .resources-section, .tips-section, .feedback-section {
                display: none;
            }
            
            .content-header {
                display: none;
            }
            
            body {
                overflow: hidden;
            }
        }

        body.dark-mode .resource-item {
            background-color: #1f2937;
            border-color: #4b5563;
            color: #f8fafc;
        }
        
        /* Auto-hiding controls */
        .custom-video-controls {
            transition: opacity 0.3s ease;
            position: relative;
            z-index: 5;
        }
        
        .full-screen-btn {
            margin-left: auto;
        }
        
        @media (max-width: 768px) {
            .custom-video-controls {
                position: absolute;
                bottom: 10px;
                left: 0;
                right: 0;
                background: rgba(0,0,0,0.5);
                padding: 10px;
                border-radius: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                gap: 10px;
            }
            
            .full-screen-btn {
                min-width: 100px;
                border-color: white;
                color: white;
                margin-left: 10px;
            }
            
            .video-player-container {
                position: relative;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Toggle button for mobile -->
        <button class="toggle-btn">
            <i class="fas fa-bars"></i>
        </button>
        
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1>O Level English</h1>
                <p>Paper 1 Mastery Course</p>
            </div>

            <!-- Premium DK Logo -->
            <div class="dk-logo-container">
                <div class="dk-logo-inner">
                    <div class="dk-logo-glow"></div>
                    <div class="dk-logo-circle"></div>
                    <div class="dk-logo-text">DK</div>
                    <div class="dk-logo-ring">
                        <div class="dk-logo-dot" style="top: 0; left: 50%;"></div>
                        <div class="dk-logo-dot" style="top: 25%; left: 93%;"></div>
                        <div class="dk-logo-dot" style="top: 75%; left: 93%;"></div>
                        <div class="dk-logo-dot" style="top: 100%; left: 50%;"></div>
                        <div class="dk-logo-dot" style="top: 75%; left: 7%;"></div>
                        <div class="dk-logo-dot" style="top: 25%; left: 7%;"></div>
                    </div>
                </div>
            </div>

            <!-- User Profile Section -->
            <div class="user-profile">
                <div class="user-avatar">
                    <img src="https://ui-avatars.com/api/?name=Student&background=random" alt="Student" id="userAvatar">
                </div>
                <div class="user-info">
                    <h3 id="userName">Student</h3>
                    <p id="userEmail">student@example.com</p>
                </div>
            </div>

            <div class="search-container">
                <div class="search-bar">
                    <input type="text" id="lectureSearch" placeholder="Search lectures...">
                    <span class="search-icon">
                        <i class="fas fa-search"></i>
                    </span>
                </div>
            </div>

            <div class="progress-bar-container" style="display: block; overflow: visible; position: relative; height: 24px;">
                <div class="progress-bar" id="progressBar" style="width: 0%; background-color: #22c55e;"></div>
                <div class="progress-text" style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; text-align: center; line-height: 24px; color: #1e293b; font-size: 12px; font-weight: 500;">0/0 completed (0%)</div>
            </div>

            <!-- Categories filter -->
            <div class="categories-filter">
                <h3 class="section-title">
                    <i class="fas fa-filter"></i> Categories
                </h3>
                <div class="filter-options">
                    <span class="filter-option active" data-filter="all">All</span>
                    <span class="filter-option" data-filter="comprehension">Comprehension</span>
                    <span class="filter-option" data-filter="summary">Summary</span>
                    <span class="filter-option" data-filter="vocabulary">Vocabulary</span>
                    <span class="filter-option" data-filter="inference">Inference</span>
                    <span class="filter-option" data-filter="exam">Exam Prep</span>
                </div>
            </div>

            <h3 class="section-title">
                <i class="fas fa-video"></i> Video Lectures
            </h3>
            <ul class="lecture-list" id="lectureList">
                <!-- Lectures will be added by JavaScript -->
            </ul>

            <h3 class="section-title">
                <i class="fas fa-bookmark"></i> Saved Lectures
            </h3>
            <ul class="saved-lecture-list" id="savedLectureList">
                <!-- Saved lectures will be added by JavaScript -->
            </ul>
        </div>
        
        <!-- Main Content with 3D Effects -->
        <main class="main-content">
            <div class="content-header">
                <div>
                    <a href="resources.html" class="back-btn">
                        <i class="fas fa-arrow-left"></i> Back to Resources
                    </a>
                    <h1 class="page-title">Paper 1 Video Masterclass</h1>
                </div>
                <div class="header-buttons">
                    <button id="resetProgressBtn" class="btn btn-outline">
                        <i class="fas fa-redo"></i> Reset Progress
                    </button>
                    <button id="darkModeToggle" class="btn btn-outline dark-mode-toggle">
                        <i class="fas fa-moon"></i> Dark Mode
                    </button>
                </div>
            </div>

            <!-- 3D Video Card -->
            <div class="video-card animated floating">
                <div class="video-player-container">
                    <div id="videoPlaceholder" style="position:absolute; top:0; left:0; width:100%; height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; color:white; background:linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);">
                        <i class="fas fa-play-circle" style="font-size:3rem; margin-bottom:1rem;"></i>
                        <h2 style="font-weight:500; margin-bottom:0.5rem;">Select a Lecture</h2>
                        <p style="opacity:0.8;">Choose from the sidebar to begin</p>
                    </div>
                    <div id="loadingSpinner" class="loading-spinner">
                        <div class="spinner"></div>
                        <div class="loading-text">Loading video...</div>
                    </div>
                    <iframe id="videoPlayer" class="video-player" frameborder="0" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" allow="autoplay; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" style="z-index:1;"></iframe>
                    <div class="video-controls-overlay">
                        <a id="youtubeDirectLink" href="#" target="_blank" class="youtube-direct-link">
                            <i class="fab fa-youtube"></i> Watch on YouTube
                        </a>
                        <div class="video-controls-right">
                            <button id="rotateScreenBtn" class="control-btn" title="Rotate Screen">
                                <i class="fas fa-mobile-alt"></i>
                            </button>
                            <button id="fullscreenBtn" class="control-btn" title="Fullscreen">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <div class="tap-instruction">
                        <i class="fas fa-hand-pointer"></i> Double-tap for fullscreen
                    </div>
                </div>

                <div class="video-info">
                    <h1 class="video-title" id="videoTitle">Paper 1 Video Lectures</h1>
                    <div class="video-meta">
                        <span><i class="fas fa-chalkboard-teacher"></i> <span id="videoInstructor">Dr. Kamran Ali</span></span>
                        <span><i class="far fa-clock"></i> <span id="videoDuration">Select a lecture</span></span>
                        <span><i class="fas fa-star" style="color:var(--warning);"></i> <span id="videoRating">4.9</span></span>
                    </div>
                    <p class="video-description" id="videoDescription">Select a lecture from the sidebar to view detailed video explanations of key Paper 1 concepts, including reading comprehension, summary writing, and vocabulary in context.</p>

                    <div class="action-buttons">
                        <button class="btn btn-primary" id="completeBtn" disabled>
                            <i class="fas fa-check-circle"></i> Mark as Complete
                        </button>
                        <button class="btn btn-outline" id="saveForLaterBtn">
                            <i class="fas fa-bookmark"></i> Save for Later
                        </button>
                    </div>

                    <div class="custom-video-controls">
                        <button class="btn btn-primary play-pause-btn">
                            <i class="fas fa-play"></i>
                        </button>
                        <button class="btn btn-outline speed-btn">
                            <i class="fas fa-tachometer-alt"></i> Speed
                        </button>
                        <button class="btn btn-outline captions-btn">
                            <i class="fas fa-closed-captioning"></i> Captions
                        </button>
                        <button class="btn btn-warning reload-btn" onclick="reloadVideo()">
                            <i class="fas fa-sync-alt"></i> Reload Video
                        </button>
                        <div class="video-timeline">
                            <input type="range" class="timeline-slider" min="0" max="100" value="0">
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3D Resources Section -->
            <div class="resources-section animated" id="resourcesSection" style="display:none;">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-paperclip"></i> Lecture Resources
                    </h3>
                </div>
                <div class="resources-grid" id="resourcesGrid">
                    <!-- Resources will be added by JavaScript -->
                </div>
            </div>

            <!-- Tips Section -->
            <div class="tips-section animated" id="tipsSection">
                <div class="section-header">
                    <h3>
                        <i class="fas fa-lightbulb"></i> Paper 1 Exam Tips
                    </h3>
                </div>
                <div class="tips-icons">
                    <div class="tip-icon active" data-tip="1">1</div>
                    <div class="tip-icon" data-tip="2">2</div>
                    <div class="tip-icon" data-tip="3">3</div>
                </div>
                <div class="tip-cards-container">
                    <div class="tip-card active" data-tip="1">
                        <div class="tip-content">
                            <h4>Reading Strategy</h4>
                            <p>Read the passage thoroughly first, then scan the questions. Return to the passage with specific questions in mind, focusing on key words and context for accurate answers.</p>
                        </div>
                    </div>
                    <div class="tip-card" data-tip="2">
                        <div class="tip-content">
                            <h4>Summary Writing</h4>
                            <p>Identify main points quickly, paraphrase effectively, and maintain a concise response within the word limit. Avoid copying phrases directly from the text unless necessary.</p>
                        </div>
                    </div>
                    <div class="tip-card" data-tip="3">
                        <div class="tip-content">
                            <h4>Time Management</h4>
                            <p>Allocate approximately 1 hour for Sections 1 & 2 (reading comprehension) and 45 minutes for Section 3 (summary). Allow time to review your responses for accuracy and completeness.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feedback Form -->
            <div class="feedback-section" id="feedbackSection">
                <div class="section-header">
                    <h3><i class="fas fa-comment-alt"></i> Leave Your Feedback</h3>
                </div>
                <div id="starRating" class="star-rating">
                    <i class="far fa-star" data-rating="1"></i>
                    <i class="far fa-star" data-rating="2"></i>
                    <i class="far fa-star" data-rating="3"></i>
                    <i class="far fa-star" data-rating="4"></i>
                    <i class="far fa-star" data-rating="5"></i>
                </div>
                <div class="rating-text" id="ratingText">Select rating</div>
                
                <form id="feedbackForm" class="feedback-form">
                    <textarea id="feedbackComment" rows="3" placeholder="What did you like about this lecture?"></textarea>
                    <textarea id="feedbackImprovement" rows="3" placeholder="How can we improve this lecture?"></textarea>
                    <button type="submit">Submit Feedback</button>
                </form>
                <div id="feedbackSuccess" class="feedback-success">
                    <i class="fas fa-check-circle"></i> Thank you for your feedback!
                </div>
            </div>
            
        </main>
    </div>

    <script>
        // Global variables
        let currentLectureId = null;
        let currentFilter = 'all';
        let searchTerm = '';
        let currentRating = 0;
        let savedLectures = [];
        let currentSpeed = 1;
        let captionsEnabled = false;
        let isPlaying = false;
        let userProfile = {
            name: 'Student',
            email: 'student@example.com',
            avatar: 'https://ui-avatars.com/api/?name=Student&background=random'
        };

        // DOM Elements 
        let loadingSpinner, videoPlayer, videoPlaceholder;
        let videoTitle, videoDuration, videoInstructor, videoRating, videoDescription;
        let completeBtn, saveForLaterBtn, resourcesSection;
        let speedBtn, captionsBtn, timelineSlider;

        // DOM references initialization
        function initDOMReferences() {
            // Video elements
            loadingSpinner = document.getElementById('loadingSpinner');
            videoPlayer = document.getElementById('videoPlayer');
            videoPlaceholder = document.getElementById('videoPlaceholder');
            
            // Video info elements
            videoTitle = document.getElementById('videoTitle');
            videoDuration = document.getElementById('videoDuration');
            videoInstructor = document.getElementById('videoInstructor');
            videoRating = document.getElementById('videoRating');
            videoDescription = document.getElementById('videoDescription');
            
            // Action buttons
            completeBtn = document.getElementById('completeBtn');
            saveForLaterBtn = document.getElementById('saveForLaterBtn');
            
            // Other elements
            resourcesSection = document.getElementById('resourcesSection');
            speedBtn = document.querySelector('.speed-btn');
            captionsBtn = document.querySelector('.captions-btn');
            timelineSlider = document.querySelector('.timeline-slider');
        }

        // Document ready
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize DOM references
            initDOMReferences();
            
            // Load saved data
            loadSavedData();

            // Check for dark mode preference
            const darkModeToggle = document.getElementById('darkModeToggle');
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                if (darkModeToggle) {
                    darkModeToggle.innerHTML = '<i class="fas fa-sun"></i> Light Mode';
                }
            }

            // Initialize the app
            initApp();
        });

        // Initialize the application
        function initApp() {
            // Load user profile if exists
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                try {
                    userProfile = JSON.parse(savedProfile);
                    updateUserProfileUI();
                } catch (e) {
                    console.error('Error parsing user profile:', e);
                }
            }

            // Render lectures
            renderLectures();
            renderSavedLectures();
            updateProgressBarWithAnimation();

            // Initialize event listeners
            initEventListeners();
            
            // Setup tips section
            setupTipsSection();

            // Add click handler for video container to prevent opening in browser
            const videoContainer = document.querySelector('.video-player-container');
            if (videoContainer) {
                videoContainer.addEventListener('click', function(e) {
                    // Prevent default behavior if this is a direct click on the iframe
                    if (e.target.tagName === 'IFRAME') {
                        e.preventDefault();
                        e.stopPropagation();
                    }
                });
            }

            // Load first lecture after a short delay
            console.log("Will load first lecture shortly...");
            setTimeout(() => {
                if (courseData && courseData.length > 0) {
                    console.log("Loading first lecture (ID:", courseData[0].id, ")");
                    loadLecture(courseData[0].id);
                } else {
                    console.error("No lectures available in courseData");
                }
            }, 1000);
        }

        // Initialize all event listeners
        function initEventListeners() {
            // Check if elements exist before adding event listeners
            const toggleBtn = document.querySelector('.toggle-btn');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', toggleSidebar);
            }

            const starRatingEl = document.getElementById('starRating');
            if (starRatingEl) {
                const stars = starRatingEl.querySelectorAll('.fa-star');
                stars.forEach((star, index) => {
                    star.addEventListener('click', () => {
                        currentRating = index + 1;
                        highlightStars(currentRating);
                        updateRatingText(currentRating);
                    });
                });
            }

            const feedbackForm = document.getElementById('feedbackForm');
            if (feedbackForm) {
                feedbackForm.addEventListener('submit', submitFeedback);
            }

            // Rest of the event listeners with null checks
            const filterCategorySelect = document.getElementById('filterCategory');
            if (filterCategorySelect) {
                filterCategorySelect.addEventListener('change', filterLectures);
            }
            
            const filterSearch = document.getElementById('filterSearch');
            if (filterSearch) {
                filterSearch.addEventListener('input', filterLectures);
            }
            
            if (completeBtn) {
                completeBtn.addEventListener('click', markAsComplete);
            }
            
            if (saveForLaterBtn) {
                saveForLaterBtn.addEventListener('click', saveForLater);
            }
            
            // Video control buttons
            const reloadBtn = document.querySelector('.reload-btn');
            if (reloadBtn) {
                reloadBtn.addEventListener('click', reloadCurrentVideo);
            }
            
            // Fullscreen button
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            if (fullscreenBtn) {
                fullscreenBtn.addEventListener('click', toggleFullscreen);
            }
            
            // Rotate screen button
            const rotateScreenBtn = document.getElementById('rotateScreenBtn');
            if (rotateScreenBtn) {
                rotateScreenBtn.addEventListener('click', toggleOrientation);
            }

            // Add double-tap to fullscreen for mobile
            setupMobileVideoGestures();
            
            // Check if we need to add orientation event listener
            if (window.matchMedia("(max-width: 768px)").matches) {
                // We're on mobile, set up orientation change listeners
                window.addEventListener('orientationchange', handleOrientationChange);
                // Initial check
                handleOrientationChange();
            }
        }

        // Reload the current video (called by the reload button)
        function reloadCurrentVideo() {
            if (currentLectureId) {
                const lecture = courseData.find(l => l.id === currentLectureId);
                if (lecture && lecture.videoUrl) {
                    reloadVideo(lecture.videoUrl);
                }
            }
        }
        
        // Setup mobile video touch gestures
        function setupMobileVideoGestures() {
            const videoContainer = document.querySelector('.video-player-container');
            if (!videoContainer) return;
            
            let touchStartX = 0;
            let touchStartY = 0;
            let touchEndX = 0;
            let touchEndY = 0;
            let tapCount = 0;
            let tapTimer;
            
            // Double-tap detection
            videoContainer.addEventListener('click', function(e) {
                tapCount++;
                if (tapCount === 1) {
                    tapTimer = setTimeout(function() {
                        tapCount = 0;
                    }, 300);
                } else {
                    clearTimeout(tapTimer);
                    tapCount = 0;
                    // Double tap detected, toggle fullscreen
                    toggleFullscreen();
                }
            });
            
            // Touch start event
            videoContainer.addEventListener('touchstart', function(e) {
                touchStartX = e.changedTouches[0].screenX;
                touchStartY = e.changedTouches[0].screenY;
            }, false);
            
            // Touch end event
            videoContainer.addEventListener('touchend', function(e) {
                touchEndX = e.changedTouches[0].screenX;
                touchEndY = e.changedTouches[0].screenY;
                handleSwipeGesture();
            }, false);
            
            // Handle swipe gestures
            function handleSwipeGesture() {
                // Calculate swipe distance
                const swipeDistanceX = Math.abs(touchEndX - touchStartX);
                const swipeDistanceY = Math.abs(touchEndY - touchStartY);
                
                // Check if it's a swipe (more movement than just a tap)
                if (swipeDistanceX > 50 || swipeDistanceY > 50) {
                    // Horizontal swipe
                    if (swipeDistanceX > swipeDistanceY) {
                        // For future implementation: skip forward/backward
                    } 
                    // Vertical swipe
                    else if (swipeDistanceY > swipeDistanceX) {
                        // Swipe up for fullscreen
                        if (touchEndY < touchStartY && (touchStartY - touchEndY) > 100) {
                            toggleFullscreen();
                        }
                    }
                }
            }
        }
        
        // Handle orientation change
        function handleOrientationChange() {
            const videoContainer = document.querySelector('.video-player-container');
            if (!videoContainer) return;
            
            // Check if we're in landscape mode
            if (window.orientation === 90 || window.orientation === -90 || 
                (window.innerWidth > window.innerHeight)) {
                
                // We're in landscape, optimize for video viewing
                document.body.classList.add('landscape-mode');
                
                // Auto fullscreen in landscape if enabled
                if (localStorage.getItem('autoFullscreenInLandscape') === 'true') {
                    setTimeout(function() {
                        toggleFullscreen();
                    }, 500);
                }
            } else {
                // We're in portrait
                document.body.classList.remove('landscape-mode');
                
                // Exit fullscreen if we were in it
                if (document.fullscreenElement) {
                    document.exitFullscreen().catch(err => {
                        console.log('Error exiting fullscreen:', err);
                    });
                }
            }
        }
        
        // Toggle orientation (rotate screen)
        function toggleOrientation() {
            if (screen.orientation && screen.orientation.lock) {
                try {
                    if (screen.orientation.type.includes('portrait')) {
                        // Currently portrait, switch to landscape
                        screen.orientation.lock('landscape').then(() => {
                            console.log('Switched to landscape');
                        }).catch(err => {
                            console.log('Error locking to landscape:', err);
                        });
                    } else {
                        // Currently landscape, switch to portrait
                        screen.orientation.lock('portrait').then(() => {
                            console.log('Switched to portrait');
                        }).catch(err => {
                            console.log('Error locking to portrait:', err);
                        });
                    }
                } catch (err) {
                    console.log('Screen orientation API not supported:', err);
                    alert('Please rotate your device manually');
                }
            } else {
                // Screen Orientation API not supported
                alert('Please rotate your device manually to switch orientation');
            }
        }

        // Toggle fullscreen for the video
        function toggleFullscreen() {
            const videoContainer = document.querySelector('.video-player-container');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            const videoIframe = document.getElementById('videoPlayer');
            
            if (!videoIframe || !videoIframe.src) {
                return; // No video loaded
            }
            
            try {
                // Check if we're in fullscreen mode already
                if (!document.fullscreenElement && 
                    !document.mozFullScreenElement && 
                    !document.webkitFullscreenElement && 
                    !document.msFullscreenElement) {
                    
                    // Try the container first for desktop
                    if (videoContainer.requestFullscreen) {
                        videoContainer.requestFullscreen();
                    } else if (videoContainer.msRequestFullscreen) {
                        videoContainer.msRequestFullscreen();
                    } else if (videoContainer.mozRequestFullScreen) {
                        videoContainer.mozRequestFullScreen();
                    } else if (videoContainer.webkitRequestFullscreen) {
                        videoContainer.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                    } 
                    // If that doesn't work, try the iframe directly (less likely to work)
                    else if (videoIframe.requestFullscreen) {
                        videoIframe.requestFullscreen();
                    } else if (videoIframe.msRequestFullscreen) {
                        videoIframe.msRequestFullscreen();
                    } else if (videoIframe.mozRequestFullScreen) {
                        videoIframe.mozRequestFullScreen();
                    } else if (videoIframe.webkitRequestFullscreen) {
                        videoIframe.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                    }
                    
                    if (fullscreenBtn) {
                        fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                    }
                } else {
                    // Exit fullscreen
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    } else if (document.mozCancelFullScreen) {
                        document.mozCancelFullScreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    }
                    
                    if (fullscreenBtn) {
                        fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    }
                }
            } catch (e) {
                console.error('Error toggling fullscreen:', e);
                // Fallback method - open in new tab for YouTube videos
                if (videoIframe && videoIframe.src && videoIframe.src.includes('youtube.com/embed/')) {
                    const videoId = videoIframe.src.split('/embed/')[1].split('?')[0];
                    if (confirm('For best fullscreen experience, would you like to open this video on YouTube?')) {
                        window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
                    }
                }
            }
        }

        // Update user profile UI
        function updateUserProfileUI() {
            const userName = document.getElementById('userName');
            const userEmail = document.getElementById('userEmail');
            const userAvatar = document.getElementById('userAvatar');
            
            if (userName) userName.textContent = userProfile.name;
            if (userEmail) userEmail.textContent = userProfile.email;
            if (userAvatar) userAvatar.src = userProfile.avatar;
        }

        // Handle search functionality
        function handleSearch(e) {
            searchTerm = e.target.value.toLowerCase();
            renderLectures();
        }

        // Load a lecture by ID
        function loadLecture(id) {
            // Find the lecture in the course data
            const lecture = courseData.find(l => l.id === id);
            if (!lecture) {
                console.error('Lecture not found:', id);
                return;
            }
            
            console.log('Loading lecture:', lecture.title, 'Completed:', lecture.completed);
            
            // Update current lecture ID
            currentLectureId = id;
            
            // Update lecture information
            videoTitle.textContent = lecture.title;
            videoDuration.textContent = lecture.duration;
            videoInstructor.textContent = lecture.instructor;
            videoDescription.textContent = lecture.description;
            
            // Update rating display
            const ratingValue = lecture.rating || 0;
            videoRating.textContent = ratingValue.toFixed(1);
            
            // Enable the complete button
            if (completeBtn) {
                completeBtn.disabled = false;
                
                // Update complete button status
                if (lecture.completed) {
                    completeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Completed';
                    completeBtn.classList.add('completed');
                } else {
                    completeBtn.innerHTML = '<i class="far fa-check-circle"></i> Mark as Complete';
                    completeBtn.classList.remove('completed');
                }
            }
            
            // Update save for later button status
            const savedLectureIds = getSavedLectures();
            if (savedLectureIds.includes(id)) {
                saveForLaterBtn.innerHTML = '<i class="fas fa-check"></i> Saved';
                saveForLaterBtn.classList.add('active');
            } else {
                saveForLaterBtn.innerHTML = '<i class="fas fa-bookmark"></i> Save for Later';
                saveForLaterBtn.classList.remove('active');
            }
            
            // Show loading spinner
            showLoadingSpinner();
            
            // Load the video
            reloadVideo(lecture.videoUrl);
            
            // Load resources
            loadResources(lecture);
            
            // Update sidebar highlighting
            const lectureItems = document.querySelectorAll('.lecture-item');
            lectureItems.forEach(item => {
                item.classList.remove('active');
            });
            
            // Find and highlight the current lecture in both lists
            const allLectures = document.querySelectorAll('.lecture-item');
            allLectures.forEach(item => {
                const titleEl = item.querySelector('.lecture-title');
                if (titleEl && titleEl.textContent === lecture.title) {
                    item.classList.add('active');
                }
            });
        }

        // Reload the current video
        function reloadVideo(videoUrl) {
            // Show loading spinner
            showLoadingSpinner();
            
            if (!videoUrl) {
                // No video URL provided
                if (videoPlayer) videoPlayer.style.display = 'none';
                if (videoPlaceholder) {
                    videoPlaceholder.style.display = 'flex';
                    videoPlaceholder.innerHTML = `
                        <i class="fas fa-exclamation-circle"></i>
                        <h3>Video Not Available</h3>
                        <p>This lecture does not have a video available.</p>
                    `;
                }
                hideLoadingSpinner();
                return;
            }
            
            // Hide the placeholder
            if (videoPlaceholder) videoPlaceholder.style.display = 'none';
            
            // Extract YouTube video ID if available
            let youtubeId = '';
            if (videoUrl.includes('youtube.com/embed/')) {
                youtubeId = videoUrl.split('/embed/')[1].split('?')[0];
                
                // Update the direct YouTube link
                const youtubeDirectLink = document.getElementById('youtubeDirectLink');
                if (youtubeDirectLink) {
                    youtubeDirectLink.href = `https://www.youtube.com/watch?v=${youtubeId}`;
                }
            }
            
            // Add mobile optimization parameters to YouTube URLs
            if (videoUrl.includes('youtube.com/embed/')) {
                // Add parameters for better mobile experience if not already present
                if (!videoUrl.includes('?')) {
                    videoUrl += '?playsinline=1&rel=0&modestbranding=1&fs=1&enablejsapi=1';
                } else if (!videoUrl.includes('playsinline=1')) {
                    videoUrl += '&playsinline=1&rel=0&modestbranding=1&fs=1&enablejsapi=1';
                }
            }
            
            // Check if we're on a mobile device
            const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());
            
            // Reset the iframe by recreating it
            if (videoPlayer) {
                const parent = videoPlayer.parentNode;
                const oldIframe = videoPlayer;
                
                // Create a new iframe element
                const newIframe = document.createElement('iframe');
                newIframe.id = 'videoPlayer';
                newIframe.className = 'video-player';
                newIframe.frameBorder = '0';
                newIframe.allowFullscreen = true;
                newIframe.allow = 'autoplay; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen';
                newIframe.setAttribute('playsinline', '1');
                newIframe.setAttribute('webkitallowfullscreen', 'true');
                newIframe.setAttribute('mozallowfullscreen', 'true');
                
                if (isMobile) {
                    // Additional mobile attributes
                    newIframe.setAttribute('allowfullscreen', 'true');
                    newIframe.setAttribute('fullscreen', 'true');
                }
                
                newIframe.style.display = 'block';
                
                // Set the source to the video URL
                newIframe.src = videoUrl;
                
                // Add event handlers
                newIframe.onload = function() {
                    hideLoadingSpinner();
                };
                
                newIframe.onerror = function() {
                    hideLoadingSpinner();
                    if (videoPlaceholder) {
                        videoPlaceholder.style.display = 'flex';
                        videoPlaceholder.innerHTML = `
                            <i class="fas fa-exclamation-circle"></i>
                            <h3>Video Error</h3>
                            <p>The video could not be loaded. Please try again later.</p>
                        `;
                    }
                };
                
                // Replace the old iframe with the new one
                parent.replaceChild(newIframe, oldIframe);
                videoPlayer = newIframe;
                
                // Set a timeout to hide the spinner if the video doesn't load
                setTimeout(hideLoadingSpinner, 5000);
            }
        }
        
        // Show loading spinner
        function showLoadingSpinner() {
            if (loadingSpinner) {
                loadingSpinner.style.display = 'flex';
            }
        }
        
        // Hide loading spinner
        function hideLoadingSpinner() {
            if (loadingSpinner) {
                loadingSpinner.style.display = 'none';
            }
        }

        // Load resources for a lecture
        function loadResources(lecture) {
            // Get the resources grid element
            const resourcesGrid = document.getElementById('resourcesGrid');
            if (!resourcesGrid) return;
            
            // Clear any previous resources
            resourcesGrid.innerHTML = '';
            
            // Check if there are resources available
            if (lecture.resources && lecture.resources.length > 0) {
                document.getElementById('resourcesSection').style.display = 'block';
                
                // Create a card for each resource
                lecture.resources.forEach(resource => {
                    const card = document.createElement('div');
                    card.className = 'resource-card';
                    
                    // Determine icon based on resource type
                    let icon = 'fa-file';
                    if (resource.type === 'pdf') icon = 'fa-file-pdf';
                    if (resource.type === 'doc') icon = 'fa-file-word';
                    if (resource.type === 'video') icon = 'fa-video';
                    if (resource.type === 'link') icon = 'fa-link';
                    
                    card.innerHTML = `
                        <i class="fas ${icon}"></i>
                        <div class="resource-info">
                            <h4>${resource.title}</h4>
                            <span>${resource.type.toUpperCase()}</span>
                        </div>
                    `;
                    
                    // Add click handler if resource has a URL
                    if (resource.url) {
                        card.style.cursor = 'pointer';
                        card.addEventListener('click', () => {
                            window.open(resource.url, '_blank');
                        });
                    } else {
                        card.style.opacity = '0.7';
                        card.style.cursor = 'not-allowed';
                    }
                    
                    resourcesGrid.appendChild(card);
                });
            } else {
                // No resources available
                document.getElementById('resourcesSection').style.display = 'none';
            }
        }

        // Toggle sidebar function
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            const toggleBtn = document.querySelector('.toggle-btn');
            
            if (sidebar) {
                sidebar.classList.toggle('active');
                
                // Update the toggle button icon
                if (toggleBtn) {
                    if (sidebar.classList.contains('active')) {
                        toggleBtn.innerHTML = '<i class="fas fa-times"></i>';
                    } else {
                        toggleBtn.innerHTML = '<i class="fas fa-bars"></i>';
                    }
                }
            }
        }

        // Update progress bar
        function updateProgressBar() {
            const progressBar = document.querySelector('.progress-bar');
            const progressText = document.querySelector('.progress-text');
            
            if (!progressBar || !progressText) return;
            
            // Calculate progress percentage
            const totalLectures = courseData.length;
            const completedLectures = courseData.filter(lecture => lecture.completed).length;
            const progressPercentage = totalLectures > 0 ? (completedLectures / totalLectures) * 100 : 0;
            
            // Update progress bar and text
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `${completedLectures}/${totalLectures} completed (${Math.round(progressPercentage)}%)`;
        }

        // Get saved lectures from local storage
        function getSavedLectures() {
            try {
                const saved = localStorage.getItem('savedLectures');
                return saved ? JSON.parse(saved) : [];
            } catch (e) {
                console.error('Error parsing saved lectures:', e);
                return [];
            }
        }

        // Save progress to local storage
        function saveProgress() {
            try {
                const progress = {};
                courseData.forEach(lecture => {
                    if (lecture.completed) {
                        progress[lecture.id] = true;
                    }
                });
                localStorage.setItem('lectureProgress', JSON.stringify(progress));
            } catch (e) {
                console.error('Error saving progress:', e);
            }
        }

        // Reset filters
        function resetFilters() {
            searchTerm = '';
            currentFilter = 'all';
            
            // Reset UI elements
            const searchInput = document.getElementById('filterSearch');
            const filterSelect = document.getElementById('filterCategory');
            
            if (searchInput) searchInput.value = '';
            if (filterSelect) filterSelect.value = 'all';
            
            // Re-render lectures
            renderLectures();
        }

        // Filter lectures
        function filterLectures() {
            const searchInput = document.getElementById('filterSearch');
            const filterSelect = document.getElementById('filterCategory');
            
            if (searchInput) searchTerm = searchInput.value.toLowerCase();
            if (filterSelect) currentFilter = filterSelect.value;
            
            renderLectures();
        }

        // Render lectures in the sidebar
        function renderLectures() {
            const lectureList = document.getElementById('lectureList');
            if (!lectureList) return;
            
            // Clear the list
            lectureList.innerHTML = '';
            
            // Filter lectures based on search and filter
            const filteredLectures = courseData.filter(lecture => {
                const matchesSearch = searchTerm === '' || 
                    lecture.title.toLowerCase().includes(searchTerm) || 
                    lecture.instructor.toLowerCase().includes(searchTerm);
                    
                const matchesFilter = currentFilter === 'all' || 
                    (currentFilter === 'completed' && lecture.completed) ||
                    (currentFilter === 'uncompleted' && !lecture.completed);
                    
                return matchesSearch && matchesFilter;
            });
            
            // Create lecture items
            filteredLectures.forEach(lecture => {
                const lectureItem = document.createElement('div');
                lectureItem.className = 'lecture-item';
                if (currentLectureId === lecture.id) {
                    lectureItem.classList.add('active');
                }
                
                // Determine the icon based on completion status
                let statusIcon = 'fa-circle';
                if (lecture.completed) {
                    statusIcon = 'fa-check-circle';
                    lectureItem.classList.add('completed');
                }
                
                lectureItem.innerHTML = `
                    <div class="lecture-status">
                        <i class="fas ${statusIcon}"></i>
                    </div>
                    <div class="lecture-info">
                        <h4 class="lecture-title">${lecture.title}</h4>
                        <div class="lecture-meta">
                            <span><i class="fas fa-user"></i> ${lecture.instructor}</span>
                            <span><i class="fas fa-clock"></i> ${lecture.duration}</span>
                        </div>
                    </div>
                `;
                
                lectureItem.addEventListener('click', () => {
                    loadLecture(lecture.id);
                    
                    // On mobile, auto-close the sidebar after selection
                    if (window.innerWidth <= 991) {
                        toggleSidebar();
                    }
                });
                
                lectureList.appendChild(lectureItem);
            });
            
            // Show message if no lectures match
            if (filteredLectures.length === 0) {
                lectureList.innerHTML = `
                    <div class="no-lectures">
                        <i class="fas fa-search"></i>
                        <p>No lectures match your search criteria</p>
                        <button class="btn btn-sm btn-outline" onclick="resetFilters()">Reset Filters</button>
                    </div>
                `;
            }
        }
        
        // Render saved lectures
        function renderSavedLectures() {
            const savedLectureList = document.getElementById('savedLectureList');
            if (!savedLectureList) return;
            
            // Clear the list
            savedLectureList.innerHTML = '';
            
            // Get saved lectures data
            const savedLectureIds = getSavedLectures();
            const savedLecturesData = courseData.filter(lecture => savedLectureIds.includes(lecture.id));
            
            // Create saved lecture items
            if (savedLecturesData.length > 0) {
                savedLecturesData.forEach(lecture => {
                    const lectureItem = document.createElement('div');
                    lectureItem.className = 'lecture-item';
                    if (currentLectureId === lecture.id) {
                        lectureItem.classList.add('active');
                    }
                    
                    // Determine the icon based on completion status
                    let statusIcon = 'fa-bookmark';
                    if (lecture.completed) {
                        statusIcon = 'fa-check-circle';
                        lectureItem.classList.add('completed');
                    }
                    
                    lectureItem.innerHTML = `
                        <div class="lecture-status">
                            <i class="fas ${statusIcon}"></i>
                        </div>
                        <div class="lecture-info">
                            <h4 class="lecture-title">${lecture.title}</h4>
                            <div class="lecture-meta">
                                <span><i class="fas fa-user"></i> ${lecture.instructor}</span>
                                <span><i class="fas fa-clock"></i> ${lecture.duration}</span>
                            </div>
                        </div>
                    `;
                    
                    lectureItem.addEventListener('click', () => {
                        loadLecture(lecture.id);
                        
                        // On mobile, auto-close the sidebar after selection
                        if (window.innerWidth <= 991) {
                            toggleSidebar();
                        }
                    });
                    
                    savedLectureList.appendChild(lectureItem);
                });
            } else {
                savedLectureList.innerHTML = `
                    <div class="no-lectures">
                        <i class="fas fa-bookmark"></i>
                        <p>No saved lectures yet</p>
                        <p class="text-sm">Click "Save for Later" on any lecture to add it here</p>
                    </div>
                `;
            }
        }

        // Load saved data from localStorage
        function loadSavedData() {
            // Load custom course data if exists
            try {
                const customCourseData = localStorage.getItem('customCourseData');
                if (customCourseData) {
                    courseData = JSON.parse(customCourseData);
                }
            } catch (e) {
                console.error('Error loading custom course data:', e);
                // Keep default course data if there's an error
            }
        
            // Load completed lectures
            try {
                const savedProgress = localStorage.getItem('lectureProgress');
                if (savedProgress) {
                    const progress = JSON.parse(savedProgress);
                    
                    // Update lecture completion status
                    courseData.forEach(lecture => {
                        lecture.completed = progress[lecture.id] === true;
                    });
                } else {
                    // Reset all lectures to uncompleted
                    courseData.forEach(lecture => {
                        lecture.completed = false;
                    });
                }
            } catch (e) {
                console.error('Error parsing saved progress:', e);
                // Reset all lectures to uncompleted
                courseData.forEach(lecture => {
                    lecture.completed = false;
                });
            }
            
            // Load saved lectures
            try {
                const savedLecturesData = localStorage.getItem('savedLectures');
                if (savedLecturesData) {
                    savedLectures = JSON.parse(savedLecturesData);
                }
            } catch (e) {
                console.error('Error parsing saved lectures:', e);
                savedLectures = [];
            }
            
            // Update progress bar with animation
            updateProgressBarWithAnimation();
        }

        // Update progress bar with animation
        function updateProgressBarWithAnimation() {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.querySelector('.progress-text');
            
            if (!progressBar || !progressText) {
                console.error('Progress bar elements not found:', progressBar, progressText);
                return;
            }
            
            // Calculate progress percentage
            const totalLectures = courseData.length;
            const completedLectures = courseData.filter(lecture => lecture.completed).length;
            const progressPercentage = totalLectures > 0 ? (completedLectures / totalLectures) * 100 : 0;
            
            console.log('Updating progress bar:', completedLectures, '/', totalLectures, '=', progressPercentage + '%');
            
            // Force recalculation by setting width to 0 first
            progressBar.style.width = '0%';
            
            // Force reflow to ensure transition works
            void progressBar.offsetWidth;
            
            // Update progress bar width with animation after small delay
            setTimeout(() => {
                progressBar.style.width = `${progressPercentage}%`;
                
                // Update text
                progressText.textContent = `${completedLectures}/${totalLectures} completed (${Math.round(progressPercentage)}%)`;
                
                console.log('Set progress bar width to', progressBar.style.width);
            }, 50);
        }

        // Show completion animation
        function showCompletionAnimation() {
            console.log('Showing completion animation');
            
            // Create an animated checkmark effect
            const checkmarkContainer = document.createElement('div');
            checkmarkContainer.className = 'completion-animation';
            checkmarkContainer.innerHTML = '<i class="fas fa-check-circle"></i>';
            
            // Append to video container
            const videoContainer = document.querySelector('.video-player-container');
            if (videoContainer) {
                // Remove any existing animations first
                const existingAnimation = document.querySelector('.completion-animation');
                if (existingAnimation) {
                    existingAnimation.remove();
                }
                
                videoContainer.appendChild(checkmarkContainer);
                console.log('Added animation to video container');
                
                // Remove after animation completes
                setTimeout(() => {
                    if (checkmarkContainer.parentNode) {
                        checkmarkContainer.remove();
                        console.log('Removed animation');
                    }
                }, 2000); // Match the animation duration
            } else {
                console.error('Video container not found for animation');
            }
            
            // Also add animation to the progress bar for emphasis
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.transition = 'width 1s cubic-bezier(0.12, 0.8, 0.3, 1.8)';
                setTimeout(() => {
                    progressBar.style.transition = 'width 0.8s cubic-bezier(0.22, 0.61, 0.36, 1)';
                }, 1000);
            }
        }

        // Mark lecture as complete
        function markAsComplete() {
            console.log('markAsComplete function called');
            
            if (!currentLectureId) {
                console.error('No lecture selected (currentLectureId is null)');
                return;
            }
            
            // Find the lecture in course data
            const lecture = courseData.find(l => l.id === currentLectureId);
            if (!lecture) {
                console.error('Lecture not found:', currentLectureId);
                return;
            }
            
            // Set as completed (not toggle - to make sure progress increases)
            lecture.completed = true;
            console.log('Marked lecture as completed:', lecture.title);
            
            // Update button appearance
            if (completeBtn) {
                completeBtn.innerHTML = '<i class="fas fa-check-circle"></i> Completed';
                completeBtn.classList.add('completed');
                
                // Disable the button to prevent multiple clicks
                completeBtn.disabled = true;
                
                // Re-enable after animation
                setTimeout(() => {
                    completeBtn.disabled = false;
                }, 2000);
                
                // Show completion animation
                showCompletionAnimation();
            }
            
            // Update the lecture in sidebar
            renderLectures();
            renderSavedLectures();
            
            // Update progress bar with animation
            updateProgressBarWithAnimation();
            
            // Direct DOM manipulation to ensure progress bar is visible
            setTimeout(() => {
                const progressBar = document.getElementById('progressBar');
                const totalLectures = courseData.length;
                const completedLectures = courseData.filter(lecture => lecture.completed).length;
                const progressPercentage = totalLectures > 0 ? (completedLectures / totalLectures) * 100 : 0;
                
                if (progressBar) {
                    progressBar.style.width = `${progressPercentage}%`;
                    console.log('Directly set progress bar width to', progressPercentage + '%');
                }
            }, 100);
            
            // Save progress
            saveProgress();
            
            console.log('markAsComplete function completed');
        }

        // Save a lecture for later viewing
        function saveForLater() {
            if (!currentLectureId) return;
            
            // Get current saved lectures
            const savedLectureIds = getSavedLectures();
            
            // Toggle saved status
            const index = savedLectureIds.indexOf(currentLectureId);
            if (index !== -1) {
                // Remove from saved list
                savedLectureIds.splice(index, 1);
                saveForLaterBtn.innerHTML = '<i class="fas fa-bookmark"></i> Save for Later';
                saveForLaterBtn.classList.remove('active');
            } else {
                // Add to saved list
                savedLectureIds.push(currentLectureId);
                saveForLaterBtn.innerHTML = '<i class="fas fa-check"></i> Saved';
                saveForLaterBtn.classList.add('active');
            }
            
            // Update global array
            savedLectures = savedLectureIds;
            
            // Save to localStorage
            try {
                localStorage.setItem('savedLectures', JSON.stringify(savedLectureIds));
            } catch (e) {
                console.error('Error saving lectures:', e);
            }
            
            // Re-render saved lectures
            renderSavedLectures();
        }

        // Setup tips section
        function setupTipsSection() {
            const tipIcons = document.querySelectorAll('.tip-icon');
            const tipCards = document.querySelectorAll('.tip-card');
            
            if (tipIcons.length === 0 || tipCards.length === 0) return;
            
            tipIcons.forEach(icon => {
                icon.addEventListener('click', () => {
                    const tipNumber = icon.getAttribute('data-tip');
                    
                    // Remove active class from all icons and cards
                    tipIcons.forEach(i => i.classList.remove('active'));
                    tipCards.forEach(card => card.classList.remove('active'));
                    
                    // Add active class to selected icon and card
                    icon.classList.add('active');
                    document.querySelector(`.tip-card[data-tip="${tipNumber}"]`).classList.add('active');
                });
            });
        }

        // Submit feedback
        function submitFeedback(e) {
            e.preventDefault();
            
            const comment = document.getElementById('feedbackComment').value;
            const improvement = document.getElementById('feedbackImprovement').value;
            
            // Validate feedback
            if (currentRating === 0) {
                alert('Please select a rating before submitting.');
                return;
            }
            
            // Prepare feedback data
            const feedback = {
                lectureId: currentLectureId,
                rating: currentRating,
                comment: comment,
                improvement: improvement,
                date: new Date().toISOString()
            };
            
            // Save feedback to localStorage
            try {
                // Get existing feedback
                const savedFeedback = localStorage.getItem('lectureFeedback') || '{}';
                const feedbackData = JSON.parse(savedFeedback);
                
                // Add/update feedback for this lecture
                feedbackData[currentLectureId] = feedback;
                
                // Save back to localStorage
                localStorage.setItem('lectureFeedback', JSON.stringify(feedbackData));
                
                // Show success message
                const successMsg = document.getElementById('feedbackSuccess');
                if (successMsg) {
                    successMsg.style.display = 'block';
                    setTimeout(() => {
                        successMsg.style.display = 'none';
                    }, 3000);
                }
                
                // Reset form
                document.getElementById('feedbackComment').value = '';
                document.getElementById('feedbackImprovement').value = '';
                highlightStars(0);
                currentRating = 0;
                
            } catch (e) {
                console.error('Error saving feedback:', e);
                alert('There was a problem saving your feedback. Please try again.');
            }
        }

        // Highlight stars based on rating
        function highlightStars(rating) {
            const stars = document.querySelectorAll('#starRating i');
            
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.className = 'fas fa-star';
                } else {
                    star.className = 'far fa-star';
                }
            });
        }

        // Update rating text
        function updateRatingText(rating) {
            const ratingText = document.getElementById('ratingText');
            if (!ratingText) return;
            
            const ratingLabels = [
                'Select rating',
                'Poor',
                'Fair',
                'Good',
                'Very Good',
                'Excellent'
            ];
            
            ratingText.textContent = ratingLabels[rating] || 'Select rating';
        }

        // Add a YouTube video to the course
        function addYouTubeVideo(title, instructor, duration, description, youtubeUrl, category) {
            // Validate inputs
            if (!title || !instructor || !duration || !description || !youtubeUrl || !category) {
                console.error('All fields are required to add a YouTube video');
                return false;
            }
            
            // Convert standard YouTube URL to embed format
            let embedUrl = youtubeUrl;
            
            // Handle standard YouTube URLs (convert to embed format)
            if (youtubeUrl.includes('youtube.com/watch')) {
                const videoId = youtubeUrl.split('v=')[1].split('&')[0];
                embedUrl = `https://www.youtube.com/embed/${videoId}`;
            } else if (youtubeUrl.includes('youtu.be/')) {
                const videoId = youtubeUrl.split('youtu.be/')[1].split('?')[0];
                embedUrl = `https://www.youtube.com/embed/${videoId}`;
            }
            
            // Create a unique ID for the new lecture
            const newId = `lecture-${Date.now()}`;
            
            // Create the new lecture object
            const newLecture = {
                id: newId,
                title: title,
                instructor: instructor,
                duration: duration,
                rating: 5.0, // Default rating
                description: description,
                videoUrl: embedUrl,
                completed: false,
                category: category,
                resources: []
            };
            
            // Add to course data
            courseData.push(newLecture);
            
            // Update the sidebar
            renderLectures();
            renderSavedLectures();
            updateProgressBarWithAnimation();
            
            // Save to localStorage for persistence
            try {
                localStorage.setItem('customCourseData', JSON.stringify(courseData));
                console.log('Video added successfully:', newLecture.title);
                return true;
            } catch (e) {
                console.error('Error saving course data:', e);
                return false;
            }
        }
        
        // Add a resource to a lecture
        function addResourceToLecture(lectureId, title, type, url) {
            const lecture = courseData.find(l => l.id === lectureId);
            if (!lecture) {
                console.error('Lecture not found:', lectureId);
                return false;
            }
            
            if (!lecture.resources) {
                lecture.resources = [];
            }
            
            lecture.resources.push({
                title: title,
                type: type,
                url: url
            });
            
            // Save to localStorage
            try {
                localStorage.setItem('customCourseData', JSON.stringify(courseData));
                console.log('Resource added to lecture:', title);
                return true;
            } catch (e) {
                console.error('Error saving resource:', e);
                return false;
            }
        }

        // Usage examples:
        // Add a YouTube video to the course:
        // addYouTubeVideo(
        //     'Advanced Summary Techniques', 
        //     'Prof. Johnson', 
        //     '28:45', 
        //     'Learn advanced techniques for summary writing in Paper 2', 
        //     'https://www.youtube.com/watch?v=dQw4w9WgXcQ', 
        //     'summary'
        // );
        
        // Add a resource to a lecture:
        // addResourceToLecture(
        //     'lecture-1',  // The lecture ID
        //     'Practice Worksheet', 
        //     'pdf', 
        //     'https://example.com/worksheet.pdf'
        // );

        // Sample course data (for demo purposes)
        const courseData = [
            {
                id: 'lecture-1',
                title: "Simulation Exam style for paper 1 and paper 2",
                description: "",
                duration: "0.46",
                instructor: "Dr. Kamran Ali",
                rating: 5.0,
                videoUrl: "https://www.youtube.com/embed/Y7E3ScH3zTk",
                thumbnail: "https://img.youtube.com/vi/Y7E3ScH3zTk/maxresdefault.jpg",
                category: "Simulated Exam style",
                completed: false
            },


            {
                id: 'lecture-2',
                title: "How to Approach Paper 1 SEC A Q1",
                description: "In this section i will guide how to approach section A Q1",
                duration: "0.46",
                instructor: "Dr. Kamran Ali",
                rating: 5.0,
                videoUrl: "https://www.youtube.com/embed/ZdcmMOJTnNc",
                thumbnail: "https://img.youtube.com/vi/ZdcmMOJTnNc/maxresdefault.jpg",
                category: "directed-writing",
                completed: false
            },

            
            {
                id: 'lecture-3',
                title: " The Mountain Path Q1 a and b",
                description: "learn about the mountain path question and how to approach it",
                duration: "7.35",
                instructor: "Dr. Kamran Ali",
                rating: 5.0,
                videoUrl: "https://www.youtube.com/embed/XQBXQjT-1vc",
                thumbnail: "https://img.youtube.com/vi/XQBXQjT-1vc/maxresdefault.jpg",
                category: "directed-writing",
                completed: false
            },


            {
                id: 'lecture-4',
                title: " The Mountain Path Guided Practice SEC A TEXT A PAPER 1 Lecture 2 c,d,e",
                description: "learn about the mountain path question and how to approach it",
                duration: "15.11",
                instructor: "Dr. Kamran Ali",
                rating: 5.0,
                videoUrl: "https://www.youtube.com/embed/_xnZJPIIrq0",
                thumbnail: "https://img.youtube.com/vi/XQBXQjT-1vc/maxresdefault.jpg",
                category: "directed-writing",
                completed: false
            },

            
            {
                id: 'lecture-5',
                title: " Maya SEC A TEXT A PAPER 1 a,b,c",
                description: "learn about the maya sec A TEXT A PAPER 1 a,b,c",
                duration: "12.21",
                instructor: "Dr. Kamran Ali",
                rating: 5.0,
                videoUrl: "https://www.youtube.com/embed/dugpBHrvTgU",
                thumbnail: "https://img.youtube.com/vi/XQBXQjT-1vc/maxresdefault.jpg",
                category: "directed-writing",
                completed: false
            },




            ];
        
            
        
           
           
        
    </script>

    <script>
    (function() {
      // Ensure the DOM is loaded
      document.addEventListener('DOMContentLoaded', () => {
        const videoContainer = document.querySelector('.video-player-container');
        const videoControls = document.querySelector('.custom-video-controls');
        const fullScreenBtn = document.getElementById('fullscreenBtn'); // Use existing button

        // Auto-hide controls function
        let controlsTimeout;
        function showControls() {
          if (videoControls) {
            videoControls.style.opacity = '1';
            resetControlsTimeout();
          }
        }
        function hideControls() {
          if (videoControls) {
            videoControls.style.opacity = '0';
          }
        }
        function resetControlsTimeout() {
          clearTimeout(controlsTimeout);
          controlsTimeout = setTimeout(hideControls, 3000);
        }

        // Show controls on any mouse move or touch on the video container
        if (videoContainer) {
          videoContainer.addEventListener('mousemove', showControls);
          videoContainer.addEventListener('touchstart', showControls);
        }

        // Connect to the existing toggleFullscreen function
        if (fullScreenBtn) {
          fullScreenBtn.addEventListener('click', toggleFullscreen); // Use existing function
        }

        // Also enable double-tap to fullscreen
        let tapCount = 0;
        let tapTimer;
        
        if (videoContainer) {
          videoContainer.addEventListener('click', function(e) {
            if (e.target.tagName !== 'BUTTON' && e.target.tagName !== 'A') {
              tapCount++;
              if (tapCount === 1) {
                tapTimer = setTimeout(function() {
                  tapCount = 0;
                  showControls(); // Single tap just shows controls
                }, 300);
              } else {
                clearTimeout(tapTimer);
                tapCount = 0;
                toggleFullscreen(); // Use existing function for double tap
              }
            }
          });
        }

        // Initialize by showing controls then auto-hiding
        showControls();
      });
    })();
    </script>

    <!-- Mobile fullscreen fix script -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get references to key elements
        const videoContainer = document.querySelector('.video-player-container');
        const videoIframe = document.getElementById('videoPlayer');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const videoControls = document.querySelector('.custom-video-controls');
        const youtubeDirectLink = document.getElementById('youtubeDirectLink');
        
        // Auto-hide controls
        let controlsTimeout;
        
        function showControls() {
            if (videoControls) {
                videoControls.style.opacity = '1';
                clearTimeout(controlsTimeout);
                controlsTimeout = setTimeout(() => {
                    videoControls.style.opacity = '0';
                }, 3000);
            }
        }
        
        // Show controls on mouse movement or touch
        if (videoContainer) {
            videoContainer.addEventListener('mousemove', showControls);
            videoContainer.addEventListener('touchstart', showControls);
        }
        
        // Update YouTube direct link whenever the video changes
        function updateYoutubeLink() {
            if (videoIframe && videoIframe.src && videoIframe.src.includes('youtube.com/embed/')) {
                const videoId = videoIframe.src.split('/embed/')[1].split('?')[0];
                if (youtubeDirectLink) {
                    youtubeDirectLink.href = `https://www.youtube.com/watch?v=${videoId}`;
                    youtubeDirectLink.style.display = 'flex';
                }
            }
        }
        
        // Create observer to watch for video source changes
        if (videoIframe) {
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.attributeName === 'src') {
                        updateYoutubeLink();
                    }
                });
            });
            observer.observe(videoIframe, { attributes: true });
            
            // Check immediately in case video is already loaded
            updateYoutubeLink();
        }
        
        // Simple fullscreen toggle function
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                // Enter fullscreen
                videoContainer.requestFullscreen().catch(err => {
                    console.error(`Error attempting to enable fullscreen: ${err.message}`);
                    
                    // Mobile fallback - offer to open in YouTube
                    if (/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase())) {
                        if (videoIframe && videoIframe.src && videoIframe.src.includes('youtube.com/embed/')) {
                            const videoId = videoIframe.src.split('/embed/')[1].split('?')[0];
                            if (confirm('For best fullscreen experience, would you like to open this video on YouTube?')) {
                                window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
                            }
                        }
                    }
                });
                
                if (fullscreenBtn) {
                    fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
                }
            } else {
                // Exit fullscreen
                document.exitFullscreen();
                
                if (fullscreenBtn) {
                    fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
                }
            }
        }
        
        // Connect fullscreen button
        if (fullscreenBtn) {
            fullscreenBtn.addEventListener('click', toggleFullscreen);
        }
        
        // Handle double-tap for fullscreen
        let tapCount = 0;
        let tapTimer;
        
        if (videoContainer) {
            videoContainer.addEventListener('click', function(e) {
                // Ignore clicks on buttons or links
                if (e.target.tagName !== 'BUTTON' && e.target.tagName !== 'A') {
                    tapCount++;
                    if (tapCount === 1) {
                        tapTimer = setTimeout(function() {
                            tapCount = 0;
                            showControls(); // Single tap shows controls
                        }, 300);
                    } else {
                        clearTimeout(tapTimer);
                        tapCount = 0;
                        toggleFullscreen(); // Double tap toggles fullscreen
                    }
                }
            });
        }
        
        // Initialize by showing controls
        showControls();
    });
    </script>

    <!-- Additional functions for mobile support and debugging -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Add test function to window for debugging in console
        window.testProgressBar = function(percentage) {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.querySelector('.progress-text');
            
            if (!progressBar || !progressText) {
                console.error('Progress bar elements not found');
                return;
            }
            
            // Default to 50% if no percentage provided
            if (percentage === undefined) percentage = 50;
            
            // Update bar and text
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `Test: ${percentage}% complete`;
            
            // Log what we did
            console.log(`Set progress bar to ${percentage}%`);
            console.log('Current style:', progressBar.style.width);
            console.log('Computed style:', window.getComputedStyle(progressBar).width);
        };
        
        // Add a direct click handler for the complete button
        const completeBtn = document.getElementById('completeBtn');
        if (completeBtn) {
            console.log('Adding direct click handler to completeBtn');
            completeBtn.addEventListener('click', function() {
                console.log('Complete button clicked directly');
                if (typeof markAsComplete === 'function') {
                    markAsComplete();
                } else {
                    console.error('markAsComplete function not found');
                }
            });
        } else {
            console.error('completeBtn element not found');
        }
        
        // Add reset button functionality
        const resetProgressBtn = document.getElementById('resetProgressBtn');
        if (resetProgressBtn) {
            console.log('Adding click handler to resetProgressBtn');
            resetProgressBtn.addEventListener('click', function() {
                console.log('Reset button clicked');
                
                // Reset all lectures to uncompleted
                courseData.forEach(lecture => {
                    lecture.completed = false;
                });
                
                // Clear localStorage progress
                localStorage.removeItem('lectureProgress');
                
                // Render lectures and update progress bar
                renderLectures();
                renderSavedLectures();
                updateProgressBarWithAnimation();
                
                // If a lecture is currently loaded, update its button
                if (currentLectureId && completeBtn) {
                    completeBtn.innerHTML = '<i class="far fa-check-circle"></i> Mark as Complete';
                    completeBtn.classList.remove('completed');
                }
                
                alert('Progress has been reset!');
            });
        }
    });
    </script>
</body>
</html>